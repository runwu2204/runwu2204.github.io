<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>runwu2204</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2023-07-09T15:45:17.000Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>runwu2204</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>SWPUCTF 2021 新生赛crypto1</title>
    <link href="http://example.com/2023/07/09/CTF%20WP/Crypto/SWPUCTF%202021%20%E6%96%B0%E7%94%9F%E8%B5%9Bcrypto1/"/>
    <id>http://example.com/2023/07/09/CTF%20WP/Crypto/SWPUCTF%202021%20%E6%96%B0%E7%94%9F%E8%B5%9Bcrypto1/</id>
    <published>2023-07-09T15:39:13.000Z</published>
    <updated>2023-07-09T15:45:17.000Z</updated>
    
    <content type="html"><![CDATA[<p>[<a class="link"   href="https://www.nssctf.cn/problem/412" >SWPUCTF 2021 新生赛]crypto1 | NSSCTF <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p><p>题干</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">flag  = <span class="string">&#x27;****************************&#x27;</span></span><br><span class="line">flag = &#123;<span class="string">&quot;asfajgfbiagbwe&quot;</span>&#125;</span><br><span class="line">p = getPrime(<span class="number">2048</span>)</span><br><span class="line">q = getPrime(<span class="number">2048</span>)</span><br><span class="line">m1 = bytes_to_long(<span class="built_in">bytes</span>(flag.encode()))</span><br><span class="line"></span><br><span class="line">e1e2 = <span class="number">3087</span></span><br><span class="line">n = p*q</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">flag1 = <span class="built_in">pow</span>(m1,e1,n)</span><br><span class="line">flag2 = <span class="built_in">pow</span>(m1,e2,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;flag1= &#x27;</span>+<span class="built_in">str</span>(flag1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;flag2= &#x27;</span>+<span class="built_in">str</span>(flag2))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n= &#x27;</span>+<span class="built_in">str</span>(n))</span><br></pre></td></tr></table></figure></div><p>给了flag1和flag2，两个都i是对m加密对n取余，符合共模攻击的条件，同时e1e2满足条件e1e2&#x3D;3087</p><p>可以通过遍历所有值暴力求解，对结果进行限制</p><p>exp</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">flag1= </span><br><span class="line">flag2= </span><br><span class="line">n= </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gongmogongji</span>(<span class="params">c1, c2, e1, e2,n</span>):</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcdext,iroot</span><br><span class="line">gcd,x,y=gcdext(e1,e2)</span><br><span class="line">m=iroot((<span class="built_in">pow</span>(c1,x,n)*<span class="built_in">pow</span>(c2,y,n))%n,gcd)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">return</span> long_to_bytes(m) <span class="keyword">if</span> long_to_bytes(m)[:<span class="number">6</span>]==<span class="string">b&#x27;NSSCTF&#x27;</span><span class="keyword">else</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">3087</span>):</span><br><span class="line"><span class="keyword">if</span>(<span class="number">3087</span>%i==<span class="number">0</span>):</span><br><span class="line">j=<span class="number">3087</span>//i</span><br><span class="line"><span class="built_in">print</span>(gongmogongji(flag1,flag2,i,j,n),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure></div><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://cdn.jsdelivr.net/gh/runwu2204/Blog_imgs/202307092345814.png"                      alt="image-20230709234504777"                ></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;[&lt;a class=&quot;link&quot;   href=&quot;https://www.nssctf.cn/problem/412&quot; &gt;SWPUCTF 2021 新生赛]crypto1 | NSSCTF &lt;i class=&quot;fa-regular fa-arrow-up-right-fro</summary>
      
    
    
    
    <category term="CTF WP" scheme="http://example.com/categories/CTF-WP/"/>
    
    <category term="Crypto" scheme="http://example.com/categories/CTF-WP/Crypto/"/>
    
    
  </entry>
  
  <entry>
    <title>Rsa共模攻击</title>
    <link href="http://example.com/2023/07/09/Crypto/Rsa%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB/"/>
    <id>http://example.com/2023/07/09/Crypto/Rsa%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB/</id>
    <published>2023-07-09T15:16:37.000Z</published>
    <updated>2023-07-09T15:38:36.000Z</updated>
    
    <content type="html"><![CDATA[<p>共模攻击主要利用的是，同一个明文通过两个互质的e对同一个n取余。（如下）</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">c1 = <span class="built_in">pow</span>(m,e1,n)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m,e2,n)</span><br></pre></td></tr></table></figure></div><p>数学上存在一个关系</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">e1*x+e2*y=gcd(e1,e2) <span class="comment">#定有x y满足这个式子</span></span><br></pre></td></tr></table></figure></div><p>同时又有(前提 m&lt;n 否则会在取余时丢失数据)</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(m^e1)^x * (m^e2)^y %n = m^(e1*x+e2*y) %n</span><br><span class="line">  (c1^x) * (c2^y) %n   = m^gcd(e1,e2)  %n</span><br><span class="line"><span class="comment">#如果两边都开gcd(e1,e2)次方则</span></span><br><span class="line">((c1^x) * (c2^y))^(<span class="number">1</span>/gcd(e1,e2))%n=m %n  </span><br></pre></td></tr></table></figure></div><p>exp:</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gongmogongji</span>(<span class="params">c1, c2, e1, e2,n</span>):</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcdext,iroot</span><br><span class="line">gcd,x,y=gcdext(e1,e2)<span class="comment">#求出e1*x+e2*y=gcd(e1,e2)的解</span></span><br><span class="line">m=iroot((<span class="built_in">pow</span>(c1,x,n)*<span class="built_in">pow</span>(c1,y,n))%n,gcd)<span class="comment">#根据((c1^x) * (c2^y))^(1/gcd(e1,e2))%n=m %n  计算出对应的m</span></span><br><span class="line"><span class="keyword">return</span> long_to_bytes(m)<span class="comment">#将m转换回bytes数组</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;共模攻击主要利用的是，同一个明文通过两个互质的e对同一个n取余。（如下）&lt;/p&gt;
&lt;div class=&quot;highlight-container&quot; data-rel=&quot;Python&quot;&gt;&lt;figure class=&quot;iseeu highlight python&quot;&gt;&lt;table</summary>
      
    
    
    
    <category term="Crypto" scheme="http://example.com/categories/Crypto/"/>
    
    
  </entry>
  
  <entry>
    <title>SWPUCTF 2021 新生赛astJS</title>
    <link href="http://example.com/2023/07/08/CTF%20WP/Re/js/ast/SWPUCTF%202021%20%E6%96%B0%E7%94%9F%E8%B5%9BastJS/"/>
    <id>http://example.com/2023/07/08/CTF%20WP/Re/js/ast/SWPUCTF%202021%20%E6%96%B0%E7%94%9F%E8%B5%9BastJS/</id>
    <published>2023-07-08T13:17:07.000Z</published>
    <updated>2023-07-08T14:08:22.000Z</updated>
    
    <content type="html"><![CDATA[<p>猜错了，可以通过escodegen包来生成对应的js代码</p><div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm i escodegen optionator  -g</span><br><span class="line">esgenerate &quot;对应的ast语法树json文件&quot;</span><br></pre></td></tr></table></figure></div><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://cdn.jsdelivr.net/gh/runwu2204/Blog_imgs/202307082207330.png"                      alt="image-20230708220700293"                ></p><p>直接运行此段代码即可</p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://cdn.jsdelivr.net/gh/runwu2204/Blog_imgs/202307082208792.png"                      alt="image-20230708220815639"                ></p><p>AST抽象语法树是在js代码生成过程中产生的，似乎是不可直接生成代码的类似于python的字节码</p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://cdn.jsdelivr.net/gh/runwu2204/Blog_imgs/202307082100647.png"                      alt="image-20230708210047544"                ></p><p>结构是层层递进的，外面是类似于程序名的东西，可以通过层层展开来寻找对应的同级的代码逻辑</p><p>下面是在body内第一个声明的，类型是函数声明(“FunctionDeclaration”)</p><div class="highlight-container" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;FunctionDeclaration&quot;</span><span class="punctuation">,</span><span class="comment">//类型函数声明</span></span><br><span class="line">  <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">18</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">177</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Identifier&quot;</span><span class="punctuation">,</span><span class="comment">//声明函数名为bE</span></span><br><span class="line">    <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">27</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">29</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;bE&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;expression&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;generator&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;async&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;params&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="comment">//声明函数的参数，此处声明了两个一个叫str，一个叫key，类型未知</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Identifier&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">30</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">33</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;str&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Identifier&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">34</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">37</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;key&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;body&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;BlockStatement&quot;</span><span class="punctuation">,</span><span class="comment">//一个代码块集合，是function的body的一部分，相当于function的代码块</span></span><br><span class="line">    <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">38</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">177</span><span class="punctuation">,</span><span class="comment">//定义代码块起始与终止位置</span></span><br><span class="line">    <span class="attr">&quot;body&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;VariableDeclaration&quot;</span><span class="punctuation">,</span><span class="comment">//此处有多层VariableDeclaration,相当于多个变量声明</span></span><br><span class="line">        <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">46</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">70</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;declarations&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;VariableDeclarator&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">50</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">69</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">              <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Identifier&quot;</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">50</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">53</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;arr&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="comment">//变量名为arr</span></span><br><span class="line">            <span class="attr">&quot;init&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="comment">//变量的初始化，为init包裹的内部的计算后的值</span></span><br><span class="line">              <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;CallExpression&quot;</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">56</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">69</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">&quot;callee&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;MemberExpression&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">56</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">65</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                  <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Identifier&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">56</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">59</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;str&quot;</span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;property&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                  <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Identifier&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">60</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">65</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;split&quot;</span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;computed&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;optional&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">              <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="comment">//调用split函数</span></span><br><span class="line">              <span class="attr">&quot;arguments&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="punctuation">&#123;</span></span><br><span class="line">                  <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Literal&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">66</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">68</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;raw&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&#x27;&#x27;&quot;</span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="comment">//传入split函数的参数</span></span><br><span class="line">              <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">&quot;optional&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;kind&quot;</span><span class="punctuation">:</span> <span class="string">&quot;var&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="comment">//可翻译为arr=str.split()</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ReturnStatement&quot;</span><span class="punctuation">,</span><span class="comment">//代码块的返回值(此处只有一个代码块，相当于整个函数的返回值)</span></span><br><span class="line">        <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">77</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">171</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;argument&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;CallExpression&quot;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">84</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">171</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;callee&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;MemberExpression&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">84</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">167</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">              <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;CallExpression&quot;</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">84</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">162</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">&quot;callee&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;MemberExpression&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">84</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">91</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                  <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Identifier&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">84</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">87</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;arr&quot;</span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;property&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                  <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Identifier&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">88</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">91</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;map&quot;</span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;computed&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;optional&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">              <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="comment">//arr.map</span></span><br><span class="line">              <span class="attr">&quot;arguments&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="punctuation">&#123;</span></span><br><span class="line">                  <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ArrowFunctionExpression&quot;</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">92</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">161</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;expression&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;generator&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;async&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;params&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                      <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Identifier&quot;</span><span class="punctuation">,</span></span><br><span class="line">                      <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">93</span><span class="punctuation">,</span></span><br><span class="line">                      <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">94</span><span class="punctuation">,</span></span><br><span class="line">                      <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;i&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="attr">&quot;body&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;BlockStatement&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">97</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">161</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;body&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                      <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ReturnStatement&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">107</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">153</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;argument&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                          <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;CallExpression&quot;</span><span class="punctuation">,</span></span><br><span class="line">                          <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">114</span><span class="punctuation">,</span></span><br><span class="line">                          <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">153</span><span class="punctuation">,</span></span><br><span class="line">                          <span class="attr">&quot;callee&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;MemberExpression&quot;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">114</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">133</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                              <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Identifier&quot;</span><span class="punctuation">,</span></span><br><span class="line">                              <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">114</span><span class="punctuation">,</span></span><br><span class="line">                              <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">120</span><span class="punctuation">,</span></span><br><span class="line">                              <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;String&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="attr">&quot;property&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="comment">//调用对应的类方法fromcharcode</span></span><br><span class="line">                              <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Identifier&quot;</span><span class="punctuation">,</span></span><br><span class="line">                              <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">121</span><span class="punctuation">,</span></span><br><span class="line">                              <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">133</span><span class="punctuation">,</span></span><br><span class="line">                              <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;fromCharCode&quot;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                            <span class="attr">&quot;computed&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">                            <span class="attr">&quot;optional&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">                          <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                          <span class="attr">&quot;arguments&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                              <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;BinaryExpression&quot;</span><span class="punctuation">,</span></span><br><span class="line">                              <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">134</span><span class="punctuation">,</span></span><br><span class="line">                              <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">152</span><span class="punctuation">,</span></span><br><span class="line">                              <span class="attr">&quot;left&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;CallExpression&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">134</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">148</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;callee&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                                  <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;MemberExpression&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                  <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">134</span><span class="punctuation">,</span></span><br><span class="line">                                  <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">146</span><span class="punctuation">,</span></span><br><span class="line">                                  <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                                    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Identifier&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                    <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">134</span><span class="punctuation">,</span></span><br><span class="line">                                    <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">135</span><span class="punctuation">,</span></span><br><span class="line">                                    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;i&quot;</span></span><br><span class="line">                                  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                                  <span class="attr">&quot;property&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                                    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Identifier&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                    <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">136</span><span class="punctuation">,</span></span><br><span class="line">                                    <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">146</span><span class="punctuation">,</span></span><br><span class="line">                                    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;charCodeAt&quot;</span></span><br><span class="line">                                  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                                  <span class="attr">&quot;computed&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">                                  <span class="attr">&quot;optional&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">                                <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;arguments&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;optional&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">                              <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                              <span class="attr">&quot;operator&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^&quot;</span><span class="punctuation">,</span></span><br><span class="line">                              <span class="attr">&quot;right&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Identifier&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">149</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">152</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;key&quot;</span></span><br><span class="line">                              <span class="punctuation">&#125;</span><span class="comment">//调用了运算符^(异或)对前面的值做右异或(有些运算符可能不满足交换律需要注意计算方向)</span></span><br><span class="line">                            <span class="punctuation">&#125;</span></span><br><span class="line">                          <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                          <span class="attr">&quot;optional&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">                        <span class="punctuation">&#125;</span></span><br><span class="line">                      <span class="punctuation">&#125;</span></span><br><span class="line">                    <span class="punctuation">]</span></span><br><span class="line">                  <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">              <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">&quot;optional&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;property&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">              <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Identifier&quot;</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">163</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">167</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;join&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;computed&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;optional&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">          <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;arguments&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">              <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Literal&quot;</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">168</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">170</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">&quot;raw&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&#x27;&#x27;&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">          <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;optional&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure></div><p>上面的基本代码逻辑就是将每个传进去的字符异或上key并返回异或后的新的字符串</p><div class="highlight-container" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ExpressionStatement&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">181</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">227</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;expression&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;CallExpression&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">181</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">227</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;callee&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;MemberExpression&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">181</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">192</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Identifier&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">181</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">188</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;console&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;property&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Identifier&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">189</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">192</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;log&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;computed&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;optional&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;arguments&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;CallExpression&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">193</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">226</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;callee&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Identifier&quot;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">193</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">195</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;bE&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;arguments&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Literal&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">196</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">222</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;EXXH_MpjxBxYnjggrM~eerv&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;raw&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&#x27;EXXH_MpjxBxYnjggrM~eerv&#x27;&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Literal&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">223</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">225</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="number">11</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;raw&quot;</span><span class="punctuation">:</span> <span class="string">&quot;11&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;optional&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;optional&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div><p>此处基本就是调用之前的函数bE，对参数”EXXH_MpjxBxYnjggrM~eerv”，异或上11，再通过console(类)的log(方法)输出flag</p><p>所以此处可以直接通过异或就能得出对应的flag</p><p>因为此处其编码无法显示出对应的字符，直接通过二进制编辑器打开，查看其二进制编码</p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://cdn.jsdelivr.net/gh/runwu2204/Blog_imgs/202307082149781.png"                      alt="image-20230708214959751"                ></p><p>exp:</p><div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">In [1]: a=[0x45 ,0x58 ,0x58 ,0x48 ,0x5F ,0x4D ,0x70 ,0x6A ,0x78 ,0x7F,0x42 ,0x78 ,0x59 ,0x6E ,0x6A ,0x67^M</span><br><span class="line">   ...: ,0x67 ,0x72,0x4D ,0x7E,0x65 ,0x65 ,0x72 ,0x76]</span><br><span class="line">   ...: ^M</span><br><span class="line">   ...:</span><br><span class="line"></span><br><span class="line">In [2]: str1=&#x27;&#x27;</span><br><span class="line">   ...: for i in a:</span><br><span class="line">   ...:     str1+=chr(i^11)</span><br><span class="line">   ...:</span><br><span class="line"></span><br><span class="line">In [3]: str1</span><br><span class="line">Out[3]: &#x27;NSSCTF&#123;astIsReallyFunny&#125;&#x27;</span><br></pre></td></tr></table></figure></div>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;猜错了，可以通过escodegen包来生成对应的js代码&lt;/p&gt;
&lt;div class=&quot;highlight-container&quot; data-rel=&quot;Shell&quot;&gt;&lt;figure class=&quot;iseeu highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td c</summary>
      
    
    
    
    <category term="CTF WP" scheme="http://example.com/categories/CTF-WP/"/>
    
    <category term="Re" scheme="http://example.com/categories/CTF-WP/Re/"/>
    
    <category term="js" scheme="http://example.com/categories/CTF-WP/Re/js/"/>
    
    <category term="ast" scheme="http://example.com/categories/CTF-WP/Re/js/ast/"/>
    
    
  </entry>
  
  <entry>
    <title>广东强网杯 2021 个人决赛findthekey</title>
    <link href="http://example.com/2023/07/05/CTF%20WP/Re/%E5%AE%89%E5%8D%93/%E5%B9%BF%E4%B8%9C%E5%BC%BA%E7%BD%91%E6%9D%AF%202021%20%E4%B8%AA%E4%BA%BA%E5%86%B3%E8%B5%9Bfindthekey/"/>
    <id>http://example.com/2023/07/05/CTF%20WP/Re/%E5%AE%89%E5%8D%93/%E5%B9%BF%E4%B8%9C%E5%BC%BA%E7%BD%91%E6%9D%AF%202021%20%E4%B8%AA%E4%BA%BA%E5%86%B3%E8%B5%9Bfindthekey/</id>
    <published>2023-07-05T03:43:17.000Z</published>
    <updated>2023-07-05T18:38:44.000Z</updated>
    
    <content type="html"><![CDATA[<p>只有一个activity组件</p><div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ctf.findthekey;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.AlertDialog;</span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.KeyEvent;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.EditText;</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: classes.dex */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">Context</span> <span class="variable">appContext</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">native</span> <span class="type">boolean</span> <span class="title function_">findthekey</span><span class="params">(Object obj)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">native</span> String <span class="title function_">stringFromJNI</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.loadLibrary(<span class="string">&quot;native-lib&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX INFO: Access modifiers changed from: protected */</span></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// androidx.appcompat.app.AppCompatActivity, androidx.fragment.app.FragmentActivity, androidx.core.app.ComponentActivity, android.app.Activity</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(C0273R.layout.activity_main);</span><br><span class="line">        appContext = getApplicationContext();</span><br><span class="line">        <span class="type">Button</span> <span class="variable">checkButton</span> <span class="operator">=</span> (Button) findViewById(C0273R.C0275id.checkButton);</span><br><span class="line">        <span class="keyword">final</span> <span class="type">EditText</span> <span class="variable">inputEditText</span> <span class="operator">=</span> (EditText) findViewById(C0273R.C0275id.inputEditText);</span><br><span class="line">        checkButton.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123; <span class="comment">// from class: com.ctf.findthekey.MainActivity.1</span></span><br><span class="line">            <span class="meta">@Override</span> <span class="comment">// android.view.View.OnClickListener</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">content</span> <span class="operator">=</span> inputEditText.getText().toString();</span><br><span class="line">                <span class="keyword">if</span> (MainActivity.<span class="built_in">this</span>.check(content)) &#123;</span><br><span class="line">                    <span class="keyword">new</span> <span class="title class_">AlertDialog</span>.Builder(<span class="built_in">this</span>).setTitle(<span class="string">&quot;result&quot;</span>).setMessage(<span class="string">&quot;Congratulations!&quot;</span>).show();</span><br><span class="line">                    inputEditText.setText(BuildConfig.FLAVOR);</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">AlertDialog</span>.Builder(<span class="built_in">this</span>).setTitle(<span class="string">&quot;result&quot;</span>).setMessage(<span class="string">&quot;Sorry,try again?&quot;</span>).show();</span><br><span class="line">                inputEditText.setText(BuildConfig.FLAVOR);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// androidx.appcompat.app.AppCompatActivity, android.app.Activity, android.view.KeyEvent.Callback</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onKeyDown</span><span class="params">(<span class="type">int</span> keyCode, KeyEvent event)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (keyCode == <span class="number">4</span>) &#123;</span><br><span class="line">            System.exit(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.onKeyDown(keyCode, event);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">check</span><span class="params">(String content)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> findthekey(content);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>直接调用JNI进行明文校验</p><p>发现JNI中的所有函数都不符合对应的findthekey这个名字经过搜索发现是经过了混淆<a class="link"   href="https://blog.csdn.net/feibabeibei_beibei/article/details/52668534" >(41条消息) Android SO文件保护加固——混淆篇（一）_android so 混淆_不知世事的博客-CSDN博客 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;只有一个activity组件&lt;/p&gt;
&lt;div class=&quot;highlight-container&quot; data-rel=&quot;Java&quot;&gt;&lt;figure class=&quot;iseeu highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;p</summary>
      
    
    
    
    <category term="CTF WP" scheme="http://example.com/categories/CTF-WP/"/>
    
    <category term="Re" scheme="http://example.com/categories/CTF-WP/Re/"/>
    
    <category term="安卓" scheme="http://example.com/categories/CTF-WP/Re/%E5%AE%89%E5%8D%93/"/>
    
    
  </entry>
  
  <entry>
    <title>pyenv</title>
    <link href="http://example.com/2023/07/03/Re/python/pyenv/"/>
    <id>http://example.com/2023/07/03/Re/python/pyenv/</id>
    <published>2023-07-03T13:24:26.000Z</published>
    <updated>2023-07-05T15:42:50.000Z</updated>
    
    <content type="html"><![CDATA[<p>先装这几个依赖</p><div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install -y build-essential libssl-dev zlib1g-dev libncurses5-dev libgdbm-dev libnss3-dev libreadline-dev libffi-dev wget libsqlite3-dev libbz2-dev xz-utils tk-dev liblzma-dev llvm libncursesw5-dev xz-utils tk-dev libxml2-dev libxmlsec1-dev libffi-dev liblzma-dev build-essential</span><br></pre></td></tr></table></figure></div><p>然后再</p><div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/pyenv/pyenv ~/.pyenv#获取源码</span><br><span class="line">echo &#x27;export PYENV_ROOT=&quot;$HOME/.pyenv&quot;&#x27; &gt;&gt; ~/.bashrc</span><br><span class="line">echo &#x27;export PATH=&quot;$PYENV_ROOT/bin:$PATH&quot;&#x27; &gt;&gt; ~/.bashrc</span><br><span class="line">echo &#x27;eval &quot;$(pyenv init -)&quot;&#x27; &gt;&gt; ~/.bashrc#配置环境变量</span><br><span class="line">source ~/.bashrc#应用修改</span><br></pre></td></tr></table></figure></div><p>就可以输入进行验证了</p><div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pyenv version</span><br></pre></td></tr></table></figure></div>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;先装这几个依赖&lt;/p&gt;
&lt;div class=&quot;highlight-container&quot; data-rel=&quot;Shell&quot;&gt;&lt;figure class=&quot;iseeu highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;s</summary>
      
    
    
    
    <category term="Re" scheme="http://example.com/categories/Re/"/>
    
    <category term="python" scheme="http://example.com/categories/Re/python/"/>
    
    
  </entry>
  
  <entry>
    <title>文件头</title>
    <link href="http://example.com/2023/07/03/Misc/%E6%96%87%E4%BB%B6%E5%A4%B4/"/>
    <id>http://example.com/2023/07/03/Misc/%E6%96%87%E4%BB%B6%E5%A4%B4/</id>
    <published>2023-07-03T13:17:05.000Z</published>
    <updated>2023-07-06T01:12:56.000Z</updated>
    
    <content type="html"><![CDATA[<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">jpeg: 47 49 46 38 39 51</span><br><span class="line">zip: 50 4b 03 04</span><br><span class="line">gif: 47 49 46 38 39 61</span><br></pre></td></tr></table></figure></div>]]></content>
    
    
      
      
    <summary type="html">&lt;div class=&quot;highlight-container&quot; data-rel=&quot;Plaintext&quot;&gt;&lt;figure class=&quot;iseeu highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span cla</summary>
      
    
    
    
    <category term="Misc" scheme="http://example.com/categories/Misc/"/>
    
    
  </entry>
  
  <entry>
    <title>GWCTF 2019babyRSA</title>
    <link href="http://example.com/2023/07/02/CTF%20WP/Crypto/GWCTF%202019babyRSA/"/>
    <id>http://example.com/2023/07/02/CTF%20WP/Crypto/GWCTF%202019babyRSA/</id>
    <published>2023-07-01T16:01:00.000Z</published>
    <updated>2023-07-01T16:12:44.000Z</updated>
    
    <content type="html"><![CDATA[<p>[<a class="link"   href="https://www.nssctf.cn/problem/247" >GWCTF 2019]babyRSA | NSSCTF <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p><p>观察主函数</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;GWHT&#123;******&#125;&#x27;</span></span><br><span class="line">secret = <span class="string">&#x27;******&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(flag) == <span class="number">38</span>)</span><br><span class="line"></span><br><span class="line">half = <span class="built_in">len</span>(flag) / <span class="number">2</span></span><br><span class="line"></span><br><span class="line">flag1 = flag[:half]</span><br><span class="line">flag2 = flag[half:]</span><br><span class="line"></span><br><span class="line">secret_num = getPrime(<span class="number">1024</span>) * bytes_to_long(secret)</span><br><span class="line"></span><br><span class="line">p = sympy.nextprime(secret_num)</span><br><span class="line">q = sympy.nextprime(p)</span><br><span class="line"></span><br><span class="line">N = p * q</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">F1 = bytes_to_long(flag1)</span><br><span class="line">F2 = bytes_to_long(flag2)</span><br><span class="line"></span><br><span class="line">c1 = F1 + F2</span><br><span class="line">c2 = <span class="built_in">pow</span>(F1, <span class="number">3</span>) + <span class="built_in">pow</span>(F2, <span class="number">3</span>)</span><br><span class="line"><span class="keyword">assert</span>(c2 &lt; N)</span><br><span class="line"></span><br><span class="line">m1 = <span class="built_in">pow</span>(c1, e, N)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c2, e, N)</span><br><span class="line"></span><br><span class="line">output = <span class="built_in">open</span>(<span class="string">&#x27;secret&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;N=&#x27;</span> + <span class="built_in">str</span>(N) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;m1=&#x27;</span> + <span class="built_in">str</span>(m1) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;m2=&#x27;</span> + <span class="built_in">str</span>(m2) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><p>给了N,m1,m2</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">N=<span class="number">636585149594574746909030160182690866222909256464847291783000651837227921337237899651287943597773270944384034858925295744880727101606841413640006527614873110651410155893776548737823152943797884729130149758279127430044739254000426610922834573094957082589539445610828279428814524313491262061930512829074466232633130599104490893572093943832740301809630847541592548921200288222432789208650949937638303429456468889100192613859073752923812454212239908948930178355331390933536771065791817643978763045030833712326162883810638120029378337092938662174119747687899484603628344079493556601422498405360731958162719296160584042671057160241284852522913676264596201906163</span></span><br><span class="line">m1=<span class="number">90009974341452243216986938028371257528604943208941176518717463554774967878152694586469377765296113165659498726012712288670458884373971419842750929287658640266219686646956929872115782173093979742958745121671928568709468526098715927189829600497283118051641107305128852697032053368115181216069626606165503465125725204875578701237789292966211824002761481815276666236869005129138862782476859103086726091860497614883282949955023222414333243193268564781621699870412557822404381213804026685831221430728290755597819259339616650158674713248841654338515199405532003173732520457813901170264713085107077001478083341339002069870585378257051150217511755761491021553239</span></span><br><span class="line">m2=<span class="number">487443985757405173426628188375657117604235507936967522993257972108872283698305238454465723214226871414276788912058186197039821242912736742824080627680971802511206914394672159240206910735850651999316100014691067295708138639363203596244693995562780286637116394738250774129759021080197323724805414668042318806010652814405078769738548913675466181551005527065309515364950610137206393257148357659666687091662749848560225453826362271704292692847596339533229088038820532086109421158575841077601268713175097874083536249006018948789413238783922845633494023608865256071962856581229890043896939025613600564283391329331452199062858930374565991634191495137939574539546</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div><p>此处p和q是两个相邻的素数</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p = sympy.nextprime(secret_num)</span><br><span class="line">q = sympy.nextprime(p)</span><br></pre></td></tr></table></figure></div><p>可以通过对N开根号求出后面的q(注意此处需要用sympy的sqrt，math库的sqrt无法求解这么大的数)</p><p>exp：</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">N=<span class="number">636585149594574746909030160182690866222909256464847291783000651837227921337237899651287943597773270944384034858925295744880727101606841413640006527614873110651410155893776548737823152943797884729130149758279127430044739254000426610922834573094957082589539445610828279428814524313491262061930512829074466232633130599104490893572093943832740301809630847541592548921200288222432789208650949937638303429456468889100192613859073752923812454212239908948930178355331390933536771065791817643978763045030833712326162883810638120029378337092938662174119747687899484603628344079493556601422498405360731958162719296160584042671057160241284852522913676264596201906163</span></span><br><span class="line">m1=<span class="number">90009974341452243216986938028371257528604943208941176518717463554774967878152694586469377765296113165659498726012712288670458884373971419842750929287658640266219686646956929872115782173093979742958745121671928568709468526098715927189829600497283118051641107305128852697032053368115181216069626606165503465125725204875578701237789292966211824002761481815276666236869005129138862782476859103086726091860497614883282949955023222414333243193268564781621699870412557822404381213804026685831221430728290755597819259339616650158674713248841654338515199405532003173732520457813901170264713085107077001478083341339002069870585378257051150217511755761491021553239</span></span><br><span class="line">m2=<span class="number">487443985757405173426628188375657117604235507936967522993257972108872283698305238454465723214226871414276788912058186197039821242912736742824080627680971802511206914394672159240206910735850651999316100014691067295708138639363203596244693995562780286637116394738250774129759021080197323724805414668042318806010652814405078769738548913675466181551005527065309515364950610137206393257148357659666687091662749848560225453826362271704292692847596339533229088038820532086109421158575841077601268713175097874083536249006018948789413238783922845633494023608865256071962856581229890043896939025613600564283391329331452199062858930374565991634191495137939574539546</span></span><br><span class="line">q=sympy.nextprime(sympy.sqrt(N))</span><br><span class="line">p=sympy.prevprime(q)</span><br><span class="line"><span class="built_in">print</span>(p*q==N)</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=<span class="built_in">int</span>(sympy.invert(e,phi))</span><br><span class="line">c1=<span class="built_in">pow</span>(m1,d,N)</span><br><span class="line">c2=<span class="built_in">pow</span>(m2,d,N)</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span>*</span><br><span class="line">f=Solver()</span><br><span class="line">F1,F2=Int(<span class="string">&#x27;F1&#x27;</span>),Int(<span class="string">&#x27;F2&#x27;</span>)</span><br><span class="line">f.add(F1+F2==c1,<span class="built_in">pow</span>(F1,<span class="number">3</span>)+<span class="built_in">pow</span>(F2,<span class="number">3</span>)==c2)</span><br><span class="line"><span class="keyword">while</span> f.check()==sat:</span><br><span class="line">    m=f.model()</span><br><span class="line">    nF1,nF2=m[F1],m[F2]</span><br><span class="line">    f.add(Or(F1!=nF1,F2!=nF2))</span><br><span class="line">    flag1,flag2=long_to_bytes(<span class="built_in">int</span>(<span class="built_in">str</span>(nF1))),long_to_bytes(<span class="built_in">int</span>(<span class="built_in">str</span>(nF2)))</span><br><span class="line">    flag=flag1+flag2</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure></div><p>最终通过求解phi(N)（(p-1)*(q-1)）和e关于模phi(N)的逆元</p><p>通过公式 c&#x3D;pow(m,d,N)就可以求解出对应的明文了</p><p>结果（因为F1和F2等价所以有两个值）</p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://cdn.jsdelivr.net/gh/runwu2204/Blog_imgs/202307020011780.png"                      alt="image-20230702001150741"                ></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;[&lt;a class=&quot;link&quot;   href=&quot;https://www.nssctf.cn/problem/247&quot; &gt;GWCTF 2019]babyRSA | NSSCTF &lt;i class=&quot;fa-regular fa-arrow-up-right-from-squa</summary>
      
    
    
    
    <category term="CTF WP" scheme="http://example.com/categories/CTF-WP/"/>
    
    <category term="Crypto" scheme="http://example.com/categories/CTF-WP/Crypto/"/>
    
    
  </entry>
  
  <entry>
    <title>BJDCTF 2020EasyRSA</title>
    <link href="http://example.com/2023/06/30/CTF%20WP/Crypto/BJDCTF%202020EasyRSA/"/>
    <id>http://example.com/2023/06/30/CTF%20WP/Crypto/BJDCTF%202020EasyRSA/</id>
    <published>2023-06-30T09:26:48.000Z</published>
    <updated>2023-06-30T09:32:47.000Z</updated>
    
    <content type="html"><![CDATA[<p>[<a class="link"   href="https://www.nssctf.cn/problem/689" >BJDCTF 2020]EasyRSA | NSSCTF <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p><p>题干</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,bytes_to_long</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> Derivative</span><br><span class="line"><span class="keyword">from</span> fractions <span class="keyword">import</span> Fraction</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line">q=getPrime(<span class="number">1024</span>)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">n=p*q</span><br><span class="line">z=Fraction(<span class="number">1</span>,Derivative(arctan(p),p))-Fraction(<span class="number">1</span>,Derivative(arth(q),q))</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(c,z,n)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></div><p>其中输出的值为从上到下依次为c,z,n</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">output:</span></span><br><span class="line"><span class="string">7922547866857761459807491502654216283012776177789511549350672958101810281348402284098310147796549430689253803510994877420135537268549410652654479620858691324110367182025648788407041599943091386227543182157746202947099572389676084392706406084307657000104665696654409155006313203957292885743791715198781974205578654792123191584957665293208390453748369182333152809882312453359706147808198922916762773721726681588977103877454119043744889164529383188077499194932909643918696646876907327364751380953182517883134591810800848971719184808713694342985458103006676013451912221080252735948993692674899399826084848622145815461035</span></span><br><span class="line"><span class="string">32115748677623209667471622872185275070257924766015020072805267359839059393284316595882933372289732127274076434587519333300142473010344694803885168557548801202495933226215437763329280242113556524498457559562872900811602056944423967403777623306961880757613246328729616643032628964072931272085866928045973799374711846825157781056965164178505232524245809179235607571567174228822561697888645968559343608375331988097157145264357626738141646556353500994924115875748198318036296898604097000938272195903056733565880150540275369239637793975923329598716003350308259321436752579291000355560431542229699759955141152914708362494482</span></span><br><span class="line"><span class="string">15310745161336895413406690009324766200789179248896951942047235448901612351128459309145825547569298479821101249094161867207686537607047447968708758990950136380924747359052570549594098569970632854351825950729752563502284849263730127586382522703959893392329333760927637353052250274195821469023401443841395096410231843592101426591882573405934188675124326997277775238287928403743324297705151732524641213516306585297722190780088180705070359469719869343939106529204798285957516860774384001892777525916167743272419958572055332232056095979448155082465977781482598371994798871917514767508394730447974770329967681767625495394441</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></div><p>给了z和n与pq的关系</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">z=Fraction(<span class="number">1</span>,Derivative(arctan(p),p))-Fraction(<span class="number">1</span>,Derivative(arth(q),q))</span><br><span class="line"><span class="comment">#Derivative用于求导，此处artan的倒数为1/(1+x^2) arth实际是反双曲正切函数artanhx倒数为1/(1-x^2)</span></span><br><span class="line"><span class="comment">#Fraction用于求分数第一个参数是分子，第二个参数是分母</span></span><br><span class="line"><span class="comment">#所以z=p^2+q^2</span></span><br></pre></td></tr></table></figure></div><p>直接通过z3求解器可求 exp:</p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">from z3 import*</span><br><span class="line">import gmpy2</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">from sympy import Derivative</span><br><span class="line">from fractions import Fraction</span><br><span class="line"># from secret import flag</span><br><span class="line"></span><br><span class="line"># p=getPrime(1024)</span><br><span class="line"># q=getPrime(1024)</span><br><span class="line">e=65537</span><br><span class="line"># n=p*q</span><br><span class="line"># z=Fraction(1,Derivative(atan(p),p))-Fraction(1,Derivative(atanh(q),q))</span><br><span class="line"># m=bytes_to_long(flag)</span><br><span class="line"># c=pow(m,e,n)</span><br><span class="line"># print(c,z,n)</span><br><span class="line">c=7922547866857761459807491502654216283012776177789511549350672958101810281348402284098310147796549430689253803510994877420135537268549410652654479620858691324110367182025648788407041599943091386227543182157746202947099572389676084392706406084307657000104665696654409155006313203957292885743791715198781974205578654792123191584957665293208390453748369182333152809882312453359706147808198922916762773721726681588977103877454119043744889164529383188077499194932909643918696646876907327364751380953182517883134591810800848971719184808713694342985458103006676013451912221080252735948993692674899399826084848622145815461035</span><br><span class="line">z=32115748677623209667471622872185275070257924766015020072805267359839059393284316595882933372289732127274076434587519333300142473010344694803885168557548801202495933226215437763329280242113556524498457559562872900811602056944423967403777623306961880757613246328729616643032628964072931272085866928045973799374711846825157781056965164178505232524245809179235607571567174228822561697888645968559343608375331988097157145264357626738141646556353500994924115875748198318036296898604097000938272195903056733565880150540275369239637793975923329598716003350308259321436752579291000355560431542229699759955141152914708362494482</span><br><span class="line">n=15310745161336895413406690009324766200789179248896951942047235448901612351128459309145825547569298479821101249094161867207686537607047447968708758990950136380924747359052570549594098569970632854351825950729752563502284849263730127586382522703959893392329333760927637353052250274195821469023401443841395096410231843592101426591882573405934188675124326997277775238287928403743324297705151732524641213516306585297722190780088180705070359469719869343939106529204798285957516860774384001892777525916167743272419958572055332232056095979448155082465977781482598371994798871917514767508394730447974770329967681767625495394441</span><br><span class="line">p,q=Int(&#x27;p&#x27;),Int(&#x27;q&#x27;)</span><br><span class="line">f=Solver()</span><br><span class="line">nz=pow(p,2)+pow(q,2)</span><br><span class="line">f.add(nz==z,p*q==n)</span><br><span class="line">while f.check()==sat:</span><br><span class="line">tmp=f.model()</span><br><span class="line">np,nq=int(str(tmp[p])),int(str(tmp[q]))</span><br><span class="line">d=gmpy2.invert(e,(np-1)*(nq-1))</span><br><span class="line">m=pow(c,d,n)</span><br><span class="line">print(long_to_bytes(m))</span><br><span class="line">f.add(p!=np,q!=nq)</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;[&lt;a class=&quot;link&quot;   href=&quot;https://www.nssctf.cn/problem/689&quot; &gt;BJDCTF 2020]EasyRSA | NSSCTF &lt;i class=&quot;fa-regular fa-arrow-up-right-from-squ</summary>
      
    
    
    
    <category term="CTF WP" scheme="http://example.com/categories/CTF-WP/"/>
    
    <category term="Crypto" scheme="http://example.com/categories/CTF-WP/Crypto/"/>
    
    
  </entry>
  
  <entry>
    <title>SWPU 2020happy  NSSCTF</title>
    <link href="http://example.com/2023/06/30/CTF%20WP/Crypto/SWPU%202020happy%20%20NSSCTF/"/>
    <id>http://example.com/2023/06/30/CTF%20WP/Crypto/SWPU%202020happy%20%20NSSCTF/</id>
    <published>2023-06-29T16:17:45.000Z</published>
    <updated>2023-06-29T16:17:45.000Z</updated>
    
    <content type="html"><![CDATA[<p>[<a class="link"   href="https://www.nssctf.cn/problem/149" >SWPU 2020]happy | NSSCTF <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(&#x27;c=&#x27;, &#x27;0x7a7e031f14f6b6c3292d11a41161d2491ce8bcdc67ef1baa9eL&#x27;)</span><br><span class="line">(&#x27;e=&#x27;, &#x27;0x872a335&#x27;)</span><br><span class="line">#q + q*p^3 =1285367317452089980789441829580397855321901891350429414413655782431779727560841427444135440068248152908241981758331600586</span><br><span class="line">#qp + q *p^2 = 1109691832903289208389283296592510864729403914873734836011311325874120780079555500202475594</span><br></pre></td></tr></table></figure></div><p>给了c和e</p><p>还有p，q之间的关系</p><p>p和q可以通过z3暴力求</p><p>根据公式</p><p>m&#x3D;c^d(mod p*q)</p><p>d为e关于mod((p-1)*(q-1))的逆元</p><p>exp:</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">c=<span class="number">0x7a7e031f14f6b6c3292d11a41161d2491ce8bcdc67ef1baa9e</span></span><br><span class="line">e=<span class="number">0x872a335</span></span><br><span class="line">f=Solver()</span><br><span class="line">p,q=Int(<span class="string">&#x27;p&#x27;</span>),Int(<span class="string">&#x27;q&#x27;</span>)</span><br><span class="line">f.add(q + q*<span class="built_in">pow</span>(p,<span class="number">3</span>) ==<span class="number">1285367317452089980789441829580397855321901891350429414413655782431779727560841427444135440068248152908241981758331600586</span>,</span><br><span class="line">q*p + q *<span class="built_in">pow</span>(p,<span class="number">2</span>) == <span class="number">1109691832903289208389283296592510864729403914873734836011311325874120780079555500202475594</span>)</span><br><span class="line"><span class="keyword">while</span> f.check()==sat:</span><br><span class="line">m=f.model()</span><br><span class="line"><span class="built_in">print</span>(m[p])</span><br><span class="line"><span class="built_in">print</span>(m[q])</span><br><span class="line">np=<span class="built_in">int</span>(<span class="built_in">str</span>(m[p]))</span><br><span class="line">nq=<span class="built_in">int</span>(<span class="built_in">str</span>(m[q]))</span><br><span class="line">f.add(p!=np,q!=nq)</span><br><span class="line">m=<span class="built_in">pow</span>(c,gmpy2.invert(e,(np-<span class="number">1</span>)*(nq-<span class="number">1</span>)),np*nq)</span><br><span class="line"><span class="comment">#gmpy2.invert用于求e关于mod phi(n)的逆元 d</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m).decode())</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;error&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure></div>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;[&lt;a class=&quot;link&quot;   href=&quot;https://www.nssctf.cn/problem/149&quot; &gt;SWPU 2020]happy | NSSCTF &lt;i class=&quot;fa-regular fa-arrow-up-right-from-square </summary>
      
    
    
    
    <category term="CTF WP" scheme="http://example.com/categories/CTF-WP/"/>
    
    <category term="Crypto" scheme="http://example.com/categories/CTF-WP/Crypto/"/>
    
    
  </entry>
  
  <entry>
    <title>pythonz3</title>
    <link href="http://example.com/2023/06/30/Re/pythonz3/pythonz3/"/>
    <id>http://example.com/2023/06/30/Re/pythonz3/pythonz3/</id>
    <published>2023-06-29T16:09:53.000Z</published>
    <updated>2023-01-08T05:20:22.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="基本变量类型"><a href="#基本变量类型" class="headerlink" title="基本变量类型"></a>基本变量类型</h1><p>其分为整型(Int)，实型(Real)和向量(BitVec)</p><h2 id="整形-int"><a href="#整形-int" class="headerlink" title="整形(int)"></a>整形(int)</h2><p>不是c中具有上下限的整形而是数学意义上的整数</p><p>创建方式</p><ol><li>Int(name, ctx&#x3D;None)，创建一个整数变量，name是名字</li><li>Ints (names, ctx&#x3D;None)，创建多个整数变量，names是空格分隔名字</li><li>IntVal (val, ctx&#x3D;None)，创建一个整数常量，有初始值，没名字。</li></ol><h2 id="实形-real"><a href="#实形-real" class="headerlink" title="实形(real)"></a>实形(real)</h2><p>是数学意义上的实数</p><p>创建方式</p><ol><li>real(name, ctx&#x3D;None)，创建一个实变量，name是名字</li><li>reals (names, ctx&#x3D;None)，创建多个实变量，names是空格分隔名字</li><li>realVal (val, ctx&#x3D;None)，创建一个实常量，有初始值，没名字。</li></ol><h2 id="向量-BitVec"><a href="#向量-BitVec" class="headerlink" title="向量(BitVec)"></a>向量(BitVec)</h2><p>数学意义上的向量</p><p>创建方式</p><p>Bitvec(name,bv,ctx&#x3D;None)，创建一个位向量，name是他的名字，bv表示大小<br>BitVecs(name,bv,ctx&#x3D;None)，创建一个有多变量的位向量，name是名字，bv表示大小<br>BitVecVal(val,bv,ctx&#x3D;None)，创建一个位向量，有初始值，没名字。</p><h1 id="python3-11下的使用"><a href="#python3-11下的使用" class="headerlink" title="python3.11下的使用"></a>python3.11下的使用</h1><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> z3</span><br><span class="line"></span><br><span class="line">x=z3.Real(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">y=z3.Real(<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">z3.solve(x&gt;<span class="number">2</span>,y&lt;<span class="number">10</span>,x+<span class="number">2</span>*y==<span class="number">7</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;&quot;&quot;&quot;</span></span><br><span class="line">[y = <span class="number">0</span>, x = <span class="number">7</span>]</span><br><span class="line"><span class="string">&quot;&quot;&quot;&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure></div><p>在python3.11下使用时需使用”.”访问符访问z3</p><p>类似使用z3这个类中的函数以及数据类型</p><h1 id="具体指令"><a href="#具体指令" class="headerlink" title="具体指令"></a>具体指令</h1><ol><li>s&#x3D;solver()，创建一个解的对象。</li><li>s.add(条件)，为解增加一个限制条件</li><li>s.check()，检查解是否存在，如果存在，会返回”sat”</li><li>model()，输出解得结果</li></ol><p>5.<code>solver.assertions()</code>查看求解器已经添加的约束和约束的个数</p><p>在计算时需给变量约束，没有约束是计算不出结果的，同时给了约束才能进行计算。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;基本变量类型&quot;&gt;&lt;a href=&quot;#基本变量类型&quot; class=&quot;headerlink&quot; title=&quot;基本变量类型&quot;&gt;&lt;/a&gt;基本变量类型&lt;/h1&gt;&lt;p&gt;其分为整型(Int)，实型(Real)和向量(BitVec)&lt;/p&gt;
&lt;h2 id=&quot;整形-int&quot;&gt;&lt;a </summary>
      
    
    
    
    <category term="Re" scheme="http://example.com/categories/Re/"/>
    
    <category term="pythonz3" scheme="http://example.com/categories/Re/pythonz3/"/>
    
    
  </entry>
  
  <entry>
    <title>Rsa学习</title>
    <link href="http://example.com/2023/06/29/Crypto/Rsa%E5%AD%A6%E4%B9%A0/"/>
    <id>http://example.com/2023/06/29/Crypto/Rsa%E5%AD%A6%E4%B9%A0/</id>
    <published>2023-06-29T06:19:35.000Z</published>
    <updated>2023-06-29T16:19:24.000Z</updated>
    
    <content type="html"><![CDATA[<p>参考</p><p><a class="link"   href="https://ctf-wiki.org/crypto/asymmetric/rsa/rsa_theory/" >RSA 介绍 - CTF Wiki (ctf-wiki.org) <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p><p><a class="link"   href="https://blog.csdn.net/qq_27765961/article/details/52138622" >(41条消息) 对于RSA算法的一些理解_y&#x3D;0 mod (p-1)&#x2F;gcd(b-1,p-1)_lxp61666666的博客-CSDN博客 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p><p><a class="link"   href="https://blog.csdn.net/qq_42539194/article/details/118514310" >(41条消息) 【RSA原理2】浅谈–什么是欧拉函数_rsa 欧拉函数是什么_韦_恩的博客-CSDN博客 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p><p><a class="link"   href="https://zhidao.baidu.com/question/137370991.html" >RSA中，e＊d＝1（mod（p-1）(q-1)）中为什么是mod（p-1）(q-1)而不是modpq？_百度知道 (baidu.com) <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p><h2 id="逆元"><a href="#逆元" class="headerlink" title="逆元"></a>逆元</h2><p>互为逆元的两个数可以取消其中一个数做的运算(一个运算中一般只有两个互为逆元的数)如e*d≡1mod(p*q)此处d取消了e做的运算</p><p>如果e乘了一个其他的数(a)那么再乘上d的值就是这个其他的数(a)</p><h2 id="基本运算"><a href="#基本运算" class="headerlink" title="基本运算"></a>基本运算</h2><p>^符号都是指 指数运算</p><p>≡符号指同余,可在≡符号右边的计算式中加入mod(num)表示等式两边取num的模同余 如 a≡b mod(c)</p><p>p,q 互不相等的质数(可以称为互素)</p><p>e 加密密钥</p><p>d 解密密钥</p><p>n 用于对加密结果取模,n&#x3D;p*q</p><p>phi（n） 用于对解密结果取模(直接用n对解密结果取模必须要求a n为不相等的质数) phi(n)&#x3D;(p-1)*(p+1)</p><h3 id="加密运算"><a href="#加密运算" class="headerlink" title="加密运算"></a>加密运算</h3><p>设flag为待加密的字符(明文),ec为已加密的数</p><p>一般通过bytes_to_long来转换为数</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">flag=<span class="string">&#x27;密文&#x27;</span></span><br><span class="line">m=bytes_to_long(<span class="built_in">bytes</span>(flag.encode()))<span class="comment">#此刻就转换为了大数</span></span><br></pre></td></tr></table></figure></div><p>通过ec≡m^e( mod n )跟ec &#x3D; m^e(mod n)一样</p><p>获得密文</p><h3 id="解密运算"><a href="#解密运算" class="headerlink" title="解密运算"></a>解密运算</h3><p>设ed为解密后的数</p><p>ed≡m^d(mod phi(n)) 跟ed &#x3D; m^d(mod phi(n))</p><p>可通过Crypto.Util.number库的long_to_bytes转化为bytes数组再转化为字符串</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag=long_to_bytes(ed).encode()</span><br></pre></td></tr></table></figure></div><h3 id="隐含条件0≤-a-c＜p-q"><a href="#隐含条件0≤-a-c＜p-q" class="headerlink" title="隐含条件0≤ a,c＜p*q"></a>隐含条件0≤ a,c＜p*q</h3><h2 id="python常用库"><a href="#python常用库" class="headerlink" title="python常用库"></a>python常用库</h2><p>gmpy2 <a class="link"   href="https://blog.csdn.net/weixin_43790779/article/details/108473984" >(41条消息) gmpy2常见函数使用_abtgu的博客-CSDN博客 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p><p>​求逆元可用于求e对应的d或者d对应的e</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">gmpy2.invert(e,phi(n))<span class="comment">#e mod n的逆元</span></span><br><span class="line">gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="comment">#值为d </span></span><br></pre></td></tr></table></figure></div>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;参考&lt;/p&gt;
&lt;p&gt;&lt;a class=&quot;link&quot;   href=&quot;https://ctf-wiki.org/crypto/asymmetric/rsa/rsa_theory/&quot; &gt;RSA 介绍 - CTF Wiki (ctf-wiki.org) &lt;i class=&quot;fa-</summary>
      
    
    
    
    <category term="Crypto" scheme="http://example.com/categories/Crypto/"/>
    
    
  </entry>
  
  <entry>
    <title>IDA导入JNI</title>
    <link href="http://example.com/2023/06/24/Re/%E5%AE%89%E5%8D%93/IDA%E5%AF%BC%E5%85%A5JNI/"/>
    <id>http://example.com/2023/06/24/Re/%E5%AE%89%E5%8D%93/IDA%E5%AF%BC%E5%85%A5JNI/</id>
    <published>2023-06-24T12:52:30.000Z</published>
    <updated>2023-06-24T12:52:30.000Z</updated>
    
    
    
    
    <category term="Re" scheme="http://example.com/categories/Re/"/>
    
    <category term="安卓" scheme="http://example.com/categories/Re/%E5%AE%89%E5%8D%93/"/>
    
    
  </entry>
  
  <entry>
    <title>羊城杯 2021Ez_android</title>
    <link href="http://example.com/2023/06/23/CTF%20WP/Re/%E5%AE%89%E5%8D%93/%E7%BE%8A%E5%9F%8E%E6%9D%AF%202021Ez_android/"/>
    <id>http://example.com/2023/06/23/CTF%20WP/Re/%E5%AE%89%E5%8D%93/%E7%BE%8A%E5%9F%8E%E6%9D%AF%202021Ez_android/</id>
    <published>2023-06-23T11:04:51.000Z</published>
    <updated>2023-06-23T11:30:52.000Z</updated>
    
    <content type="html"><![CDATA[<p>两个activity，需要注意</p><div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> <span class="attr">android:versionCode</span>=<span class="string">&quot;1&quot;</span> <span class="attr">android:versionName</span>=<span class="string">&quot;1.0&quot;</span> <span class="attr">android:compileSdkVersion</span>=<span class="string">&quot;30&quot;</span> <span class="attr">android:compileSdkVersionCodename</span>=<span class="string">&quot;11&quot;</span> <span class="attr">package</span>=<span class="string">&quot;top.zjax.login&quot;</span> <span class="attr">platformBuildVersionCode</span>=<span class="string">&quot;30&quot;</span> <span class="attr">platformBuildVersionName</span>=<span class="string">&quot;11&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-sdk</span> <span class="attr">android:minSdkVersion</span>=<span class="string">&quot;21&quot;</span> <span class="attr">android:targetSdkVersion</span>=<span class="string">&quot;30&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.INTERNET&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">application</span> <span class="attr">android:theme</span>=<span class="string">&quot;@style/Theme.Login&quot;</span> <span class="attr">android:label</span>=<span class="string">&quot;@string/app_name&quot;</span> <span class="attr">android:icon</span>=<span class="string">&quot;@mipmap/ic_launcher&quot;</span> <span class="attr">android:allowBackup</span>=<span class="string">&quot;true&quot;</span> <span class="attr">android:supportsRtl</span>=<span class="string">&quot;true&quot;</span> <span class="attr">android:roundIcon</span>=<span class="string">&quot;@mipmap/ic_launcher_round&quot;</span> <span class="attr">android:appComponentFactory</span>=<span class="string">&quot;androidx.core.app.CoreComponentFactory&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">&quot;top.zjax.login.MainActivity&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.action.MAIN&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.category.LAUNCHER&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">&quot;top.zjax.login.CheckFlagActivity&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p>mainactivity</p><div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> top.zjax.login;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.Activity;</span><br><span class="line"><span class="keyword">import</span> android.content.Intent;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.EditText;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStreamWriter;</span><br><span class="line"><span class="keyword">import</span> java.math.BigInteger;</span><br><span class="line"><span class="keyword">import</span> java.net.Socket;</span><br><span class="line"><span class="keyword">import</span> java.nio.charset.StandardCharsets;</span><br><span class="line"><span class="keyword">import</span> java.security.MessageDigest;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: classes.dex */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">Activity</span> <span class="keyword">implements</span> <span class="title class_">View</span>.OnClickListener &#123;</span><br><span class="line">    <span class="type">Button</span> <span class="variable">loginBtn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">EditText</span> <span class="variable">useridEt</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">EditText</span> <span class="variable">passEt</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">TextView</span> <span class="variable">promptText</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.app.Activity</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(C0818R.layout.activity_main);</span><br><span class="line">        <span class="type">Button</span> <span class="variable">button</span> <span class="operator">=</span> (Button) findViewById(C0818R.C0821id.loginBtn);</span><br><span class="line">        <span class="built_in">this</span>.loginBtn = button;</span><br><span class="line">        button.setOnClickListener(<span class="built_in">this</span>);</span><br><span class="line">        <span class="built_in">this</span>.useridEt = (EditText) findViewById(C0818R.C0821id.userId);</span><br><span class="line">        <span class="built_in">this</span>.passEt = (EditText) findViewById(C0818R.C0821id.pass);</span><br><span class="line">        <span class="built_in">this</span>.promptText = (TextView) findViewById(C0818R.C0821id.promptText);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.view.View.OnClickListener</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">trim</span> <span class="operator">=</span> <span class="built_in">this</span>.useridEt.getText().toString().trim();</span><br><span class="line">        <span class="type">String</span> <span class="variable">trim2</span> <span class="operator">=</span> <span class="built_in">this</span>.passEt.getText().toString().trim();</span><br><span class="line">        <span class="keyword">if</span> (trim.equals(<span class="string">&quot;&quot;</span>)) &#123;</span><br><span class="line">            <span class="built_in">this</span>.promptText.setText(C0818R.string.userIdError);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (trim2.equals(<span class="string">&quot;&quot;</span>)) &#123;</span><br><span class="line">            <span class="built_in">this</span>.promptText.setText(C0818R.string.passError);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (checkUsername(trim) &amp;&amp; checkPasswd(trim2)) &#123;</span><br><span class="line">            Toast.makeText(<span class="built_in">this</span>, (<span class="type">int</span>) C0818R.string.loginSuccess, <span class="number">1</span>).show();</span><br><span class="line">            getKeyAndRedirect(trim2);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Toast.makeText(<span class="built_in">this</span>, (<span class="type">int</span>) C0818R.string.loginError, <span class="number">1</span>).show();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">checkUsername</span><span class="params">(String username)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> username.equals(getString(C0818R.string.username));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">checkPasswd</span><span class="params">(String passwd)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> getEncodeStr(passwd).equals(getString(C0818R.string.passwd));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">getEncodeStr</span><span class="params">(String str)</span> &#123;</span><br><span class="line">        <span class="type">byte</span>[] bArr = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            bArr = MessageDigest.getInstance(getString(C0818R.string.encode)).digest(str.getBytes(StandardCharsets.UTF_8));</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; bArr.length; i++) &#123;</span><br><span class="line">                bArr[i] = (<span class="type">byte</span>) (bArr[i] - <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BigInteger</span>(<span class="number">1</span>, bArr).toString(<span class="number">16</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">getKeyAndRedirect</span><span class="params">(<span class="keyword">final</span> String passwd)</span> &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123; <span class="comment">// from class: top.zjax.login.-$$Lambda$MainActivity$6RDmmwJ9hKunKEQ8YxFB_mVwQ0E</span></span><br><span class="line">            <span class="meta">@Override</span> <span class="comment">// java.lang.Runnable</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                MainActivity.<span class="built_in">this</span>.lambda$getKeyAndRedirect$<span class="number">0</span>$MainActivity(passwd);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">this</span>.key.length() == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">1000L</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Intent</span> <span class="variable">intent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(<span class="built_in">this</span>, CheckFlagActivity.class);</span><br><span class="line">        intent.putExtra(<span class="string">&quot;key&quot;</span>, <span class="built_in">this</span>.key);</span><br><span class="line">        startActivity(intent);</span><br><span class="line">        finish();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="comment">/* synthetic */</span> <span class="keyword">void</span> lambda$getKeyAndRedirect$<span class="number">0</span>$MainActivity(<span class="keyword">final</span> String passwd) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Socket</span> <span class="variable">socket</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Socket</span>(<span class="string">&quot;139.224.191.201&quot;</span>, <span class="number">20080</span>);</span><br><span class="line">            <span class="type">BufferedWriter</span> <span class="variable">bufferedWriter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedWriter</span>(<span class="keyword">new</span> <span class="title class_">OutputStreamWriter</span>(socket.getOutputStream()));</span><br><span class="line">            <span class="type">BufferedReader</span> <span class="variable">bufferedReader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(socket.getInputStream()));</span><br><span class="line">            bufferedWriter.write(passwd);</span><br><span class="line">            bufferedWriter.newLine();</span><br><span class="line">            bufferedWriter.flush();</span><br><span class="line">            setKey(bufferedReader.readLine().split(<span class="string">&quot;:&quot;</span>)[<span class="number">1</span>].trim());</span><br><span class="line">            bufferedReader.close();</span><br><span class="line">            bufferedWriter.close();</span><br><span class="line">            socket.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setKey</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.key = key;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>通过查字符串表获取username和passwd</p><div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">checkUsername</span><span class="params">(String username)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> username.equals(getString(C0818R.string.username));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">checkPasswd</span><span class="params">(String passwd)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> getEncodeStr(passwd).equals(getString(C0818R.string.passwd));</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span> String <span class="title function_">getEncodeStr</span><span class="params">(String str)</span> &#123;<span class="comment">//此处是md5算法</span></span><br><span class="line">        <span class="type">byte</span>[] bArr = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            bArr = MessageDigest.getInstance(getString(C0818R.string.encode)).digest(str.getBytes(StandardCharsets.UTF_8));</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; bArr.length; i++) &#123;</span><br><span class="line">                bArr[i] = (<span class="type">byte</span>) (bArr[i] - <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BigInteger</span>(<span class="number">1</span>, bArr).toString(<span class="number">16</span>);</span><br><span class="line">    &#125;<span class="comment">//此处将md5后的每2个16进制数减了1</span></span><br></pre></td></tr></table></figure></div><div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">string</span> <span class="attr">name</span>=<span class="string">&quot;encode&quot;</span>&gt;</span>md5<span class="tag">&lt;/<span class="name">string</span>&gt;</span><span class="comment">&lt;!--上图的C0818R.string.encode--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">string</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">string</span> <span class="attr">name</span>=<span class="string">&quot;passwd&quot;</span>&gt;</span>c232666f1410b3f5010dc51cec341f58<span class="tag">&lt;/<span class="name">string</span>&gt;</span><span class="comment">&lt;!--此处是经过md5和一个自定义编码的passwd--&gt;</span></span><br></pre></td></tr></table></figure></div><p>实际的md5(passwd)为</p><div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">In [1]: str1=&#x27;c232666f1410b3f5010dc51cec341f58&#x27;</span><br><span class="line">In [8]: tmp1=&#x27;&#x27;</span><br><span class="line">   ...: for i in range(0,len(str1),2):</span><br><span class="line">   ...:     tmp1+=&#x27;&#123;:0&gt;2X&#125;&#x27;.format(int(str1[i]+str1[i+1],16)+1)</span><br><span class="line">   ...:</span><br><span class="line"></span><br><span class="line">In [9]: tmp1</span><br><span class="line">Out[9]: &#x27;C33367701511B4F6020EC61DED352059&#x27;</span><br></pre></td></tr></table></figure></div><p>passwd</p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://cdn.jsdelivr.net/gh/runwu2204/Blog_imgs/202306231922128.png"                      alt="image-20230623192207082"                ></p><p>其连接了一个链接输入了passwd获取了key</p><div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">public</span> <span class="comment">/* synthetic */</span> <span class="keyword">void</span> lambda$getKeyAndRedirect$<span class="number">0</span>$MainActivity(<span class="keyword">final</span> String passwd) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Socket</span> <span class="variable">socket</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Socket</span>(<span class="string">&quot;139.224.191.201&quot;</span>, <span class="number">20080</span>);</span><br><span class="line">            <span class="type">BufferedWriter</span> <span class="variable">bufferedWriter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedWriter</span>(<span class="keyword">new</span> <span class="title class_">OutputStreamWriter</span>(socket.getOutputStream()));</span><br><span class="line">            <span class="type">BufferedReader</span> <span class="variable">bufferedReader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(socket.getInputStream()));</span><br><span class="line">            bufferedWriter.write(passwd);</span><br><span class="line">            bufferedWriter.newLine();</span><br><span class="line">            bufferedWriter.flush();</span><br><span class="line">            setKey(bufferedReader.readLine().split(<span class="string">&quot;:&quot;</span>)[<span class="number">1</span>].trim());</span><br><span class="line">            bufferedReader.close();</span><br><span class="line">            bufferedWriter.close();</span><br><span class="line">            socket.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setKey</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.key = key;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\wrwrw&gt;nc node4.anna.nssctf.cn 28110</span><br><span class="line">654321</span><br><span class="line">key: TGtUnkaJD0frq61uCQYw3-FxMiRvNOB/EWjgVcpKSzbs8yHZ257X9LldIeh4APom</span><br></pre></td></tr></table></figure></div><p>其将key传给了另外的activity CheckFlagActivity</p><div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Intent</span> <span class="variable">intent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(<span class="built_in">this</span>, CheckFlagActivity.class);</span><br><span class="line">        intent.putExtra(<span class="string">&quot;key&quot;</span>, <span class="built_in">this</span>.key);</span><br><span class="line">        startActivity(intent);</span><br></pre></td></tr></table></figure></div><p>这个组件接受了key</p><div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    setContentView(C0818R.layout.activity_checkflag);</span><br><span class="line">    <span class="type">Button</span> <span class="variable">button</span> <span class="operator">=</span> (Button) findViewById(C0818R.C0821id.flagBtn);</span><br><span class="line">    <span class="built_in">this</span>.flagBtn = button;</span><br><span class="line">    button.setOnClickListener(<span class="built_in">this</span>);</span><br><span class="line">    <span class="built_in">this</span>.flagTx = (EditText) findViewById(C0818R.C0821id.flagTx);</span><br><span class="line">    <span class="built_in">this</span>.promptText = (TextView) findViewById(C0818R.C0821id.promptText);</span><br><span class="line">    <span class="built_in">this</span>.key = getIntent().getStringExtra(<span class="string">&quot;key&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><p>通过如下方法验证密文</p><div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">checkFlag</span><span class="params">(String flag)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>(EncodeUtils.encode(flag.getBytes(StandardCharsets.UTF_8), <span class="literal">false</span>, <span class="built_in">this</span>.key.getBytes(StandardCharsets.UTF_8))).equals(getString(C0818R.string.encodeFlag));</span><br><span class="line">    &#125;<span class="comment">//</span></span><br><span class="line"><span class="comment">/*************************************下面的是base64算法但encodeTable是之前获取到的key***************************/</span></span><br><span class="line"><span class="comment">//key=TGtUnkaJD0frq61uCQYw3-FxMiRvNOB/EWjgVcpKSzbs8yHZ257X9LldIeh4APom</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">byte</span>[] encode(<span class="type">byte</span>[] arr, <span class="type">boolean</span> isMultiLine, <span class="type">byte</span>[] encodeTable) &#123;</span><br><span class="line">        <span class="keyword">if</span> (arr == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> arr.length;</span><br><span class="line">        <span class="keyword">if</span> (length == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">0</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> (length / <span class="number">3</span>) * <span class="number">3</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">i2</span> <span class="operator">=</span> length - <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">i3</span> <span class="operator">=</span> ((i2 / <span class="number">3</span>) + <span class="number">1</span>) &lt;&lt; <span class="number">2</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">i4</span> <span class="operator">=</span> i3 + (isMultiLine ? ((i3 - <span class="number">1</span>) / <span class="number">76</span>) &lt;&lt; <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">        <span class="type">byte</span>[] bArr = <span class="keyword">new</span> <span class="title class_">byte</span>[i4];</span><br><span class="line">        <span class="type">int</span> <span class="variable">i5</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">i6</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">i7</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (i5 &lt; i) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">i8</span> <span class="operator">=</span> i5 + <span class="number">1</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">i9</span> <span class="operator">=</span> i8 + <span class="number">1</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">i10</span> <span class="operator">=</span> ((arr[i5] &amp; <span class="number">255</span>) &lt;&lt; <span class="number">16</span>) | ((arr[i8] &amp; <span class="number">255</span>) &lt;&lt; <span class="number">8</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">i11</span> <span class="operator">=</span> i9 + <span class="number">1</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">i12</span> <span class="operator">=</span> i10 | (arr[i9] &amp; <span class="number">255</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">i13</span> <span class="operator">=</span> i6 + <span class="number">1</span>;</span><br><span class="line">            bArr[i6] = encodeTable[(i12 &gt;&gt;&gt; <span class="number">18</span>) &amp; <span class="number">63</span>];</span><br><span class="line">            <span class="type">int</span> <span class="variable">i14</span> <span class="operator">=</span> i13 + <span class="number">1</span>;</span><br><span class="line">            bArr[i13] = encodeTable[(i12 &gt;&gt;&gt; <span class="number">12</span>) &amp; <span class="number">63</span>];</span><br><span class="line">            <span class="type">int</span> <span class="variable">i15</span> <span class="operator">=</span> i14 + <span class="number">1</span>;</span><br><span class="line">            bArr[i14] = encodeTable[(i12 &gt;&gt;&gt; <span class="number">6</span>) &amp; <span class="number">63</span>];</span><br><span class="line">            i6 = i15 + <span class="number">1</span>;</span><br><span class="line">            bArr[i15] = encodeTable[i12 &amp; <span class="number">63</span>];</span><br><span class="line">            <span class="keyword">if</span> (isMultiLine &amp;&amp; (i7 = i7 + <span class="number">1</span>) == <span class="number">19</span> &amp;&amp; i6 &lt; i4 - <span class="number">2</span>) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">i16</span> <span class="operator">=</span> i6 + <span class="number">1</span>;</span><br><span class="line">                bArr[i6] = <span class="number">13</span>;</span><br><span class="line">                i6 = i16 + <span class="number">1</span>;</span><br><span class="line">                bArr[i16] = <span class="number">10</span>;</span><br><span class="line">                i7 = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            i5 = i11;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">i17</span> <span class="operator">=</span> length - i;</span><br><span class="line">        <span class="keyword">if</span> (i17 &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">i18</span> <span class="operator">=</span> ((arr[i] &amp; <span class="number">255</span>) &lt;&lt; <span class="number">10</span>) | (i17 == <span class="number">2</span> ? (arr[i2] &amp; <span class="number">255</span>) &lt;&lt; <span class="number">2</span> : <span class="number">0</span>);</span><br><span class="line">            bArr[i4 - <span class="number">4</span>] = encodeTable[i18 &gt;&gt; <span class="number">12</span>];</span><br><span class="line">            bArr[i4 - <span class="number">3</span>] = encodeTable[(i18 &gt;&gt;&gt; <span class="number">6</span>) &amp; <span class="number">63</span>];</span><br><span class="line">            bArr[i4 - <span class="number">2</span>] = i17 == <span class="number">2</span> ? encodeTable[i18 &amp; <span class="number">63</span>] : (<span class="type">byte</span>) <span class="number">61</span>;</span><br><span class="line">            bArr[i4 - <span class="number">1</span>] = <span class="number">61</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> bArr;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">string</span> <span class="attr">name</span>=<span class="string">&quot;encodeFlag&quot;</span>&gt;</span>3lkHi9iZNK87qw0p6U391t92qlC5rwn5iFqyMFDl1t92qUnL6FQjqln76l-P<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--base64变表为  TGtUnkaJD0frq61uCQYw3-FxMiRvNOB/EWjgVcpKSzbs8yHZ257X9LldIeh4APom   --&gt;</span></span><br></pre></td></tr></table></figure></div><p>用变表解密</p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://cdn.jsdelivr.net/gh/runwu2204/Blog_imgs/202306231929640.png"                      alt="image-20230623192902530"                ></p><p>获取到了flag</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;两个activity，需要注意&lt;/p&gt;
&lt;div class=&quot;highlight-container&quot; data-rel=&quot;Xml&quot;&gt;&lt;figure class=&quot;iseeu highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pr</summary>
      
    
    
    
    <category term="CTF WP" scheme="http://example.com/categories/CTF-WP/"/>
    
    <category term="Re" scheme="http://example.com/categories/CTF-WP/Re/"/>
    
    <category term="安卓" scheme="http://example.com/categories/CTF-WP/Re/%E5%AE%89%E5%8D%93/"/>
    
    
  </entry>
  
  <entry>
    <title>GKCTF 2021App-debug</title>
    <link href="http://example.com/2023/06/23/CTF%20WP/Re/%E5%AE%89%E5%8D%93/GKCTF%202021App-debug/"/>
    <id>http://example.com/2023/06/23/CTF%20WP/Re/%E5%AE%89%E5%8D%93/GKCTF%202021App-debug/</id>
    <published>2023-06-23T09:20:26.000Z</published>
    <updated>2023-06-23T10:44:55.000Z</updated>
    
    <content type="html"><![CDATA[<p>参考wp[(41条消息) BUUCTF <a class="link"   href="https://blog.csdn.net/weixin_53349587/article/details/122394778" >GKCTF 2021]app-debug_皮皮蟹！的博客-CSDN博客 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p><p>就一个activity</p><div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> <span class="attr">android:versionCode</span>=<span class="string">&quot;1&quot;</span> <span class="attr">android:versionName</span>=<span class="string">&quot;1.0&quot;</span> <span class="attr">android:compileSdkVersion</span>=<span class="string">&quot;29&quot;</span> <span class="attr">android:compileSdkVersionCodename</span>=<span class="string">&quot;10&quot;</span> <span class="attr">package</span>=<span class="string">&quot;com.example.myapplication&quot;</span> <span class="attr">platformBuildVersionCode</span>=<span class="string">&quot;29&quot;</span> <span class="attr">platformBuildVersionName</span>=<span class="string">&quot;10&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-sdk</span> <span class="attr">android:minSdkVersion</span>=<span class="string">&quot;21&quot;</span> <span class="attr">android:targetSdkVersion</span>=<span class="string">&quot;29&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">application</span> <span class="attr">android:theme</span>=<span class="string">&quot;@style/AppTheme&quot;</span> <span class="attr">android:label</span>=<span class="string">&quot;@string/app_name&quot;</span> <span class="attr">android:icon</span>=<span class="string">&quot;@mipmap/ic_launcher&quot;</span> <span class="attr">android:debuggable</span>=<span class="string">&quot;true&quot;</span> <span class="attr">android:allowBackup</span>=<span class="string">&quot;true&quot;</span> <span class="attr">android:supportsRtl</span>=<span class="string">&quot;true&quot;</span> <span class="attr">android:roundIcon</span>=<span class="string">&quot;@mipmap/ic_launcher_round&quot;</span> <span class="attr">android:appComponentFactory</span>=<span class="string">&quot;androidx.core.app.CoreComponentFactory&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">&quot;com.example.myapplication.MainActivity&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.action.MAIN&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.category.LAUNCHER&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p>主函数就是调用了JNI</p><div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.myapplication;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.EditText;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: classes2.dex */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Button mBtnLogin;</span><br><span class="line">    <span class="keyword">private</span> EditText mEtflag;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">native</span> <span class="type">boolean</span> <span class="title function_">check</span><span class="params">(String str)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.loadLibrary(<span class="string">&quot;native-lib&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX INFO: Access modifiers changed from: protected */</span></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// androidx.appcompat.app.AppCompatActivity, androidx.fragment.app.FragmentActivity, androidx.core.app.ComponentActivity, android.app.Activity</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(C0273R.layout.activity_main);</span><br><span class="line">        <span class="built_in">this</span>.mBtnLogin = (Button) findViewById(C0273R.C0275id.btn_login);</span><br><span class="line">        <span class="built_in">this</span>.mEtflag = (EditText) findViewById(C0273R.C0275id.bEn_edittext);</span><br><span class="line">        <span class="built_in">this</span>.mBtnLogin.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123; <span class="comment">// from class: com.example.myapplication.MainActivity.1</span></span><br><span class="line">            <span class="meta">@Override</span> <span class="comment">// android.view.View.OnClickListener</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line">                <span class="type">MainActivity</span> <span class="variable">mainActivity</span> <span class="operator">=</span> MainActivity.<span class="built_in">this</span>;</span><br><span class="line">                <span class="keyword">if</span> (mainActivity.check(mainActivity.mEtflag.getText().toString())) &#123;</span><br><span class="line">                    Toast.makeText(MainActivity.<span class="built_in">this</span>, <span class="string">&quot;You Are Right!flag is flag&#123;md5(input)&#125;&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    Toast.makeText(MainActivity.<span class="built_in">this</span>, <span class="string">&quot;Sorry your flag is wrong!&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>JNI函数</p><div class="highlight-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">bool</span> __fastcall <span class="title function_">Java_com_example_myapplication_MainActivity_check</span><span class="params">(__int64 a1, __int64 a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [xsp+24h] [xbp-4Ch]</span></span><br><span class="line">  <span class="type">bool</span> v5; <span class="comment">// [xsp+4Ch] [xbp-24h]</span></span><br><span class="line">  <span class="type">char</span> v6[<span class="number">24</span>]; <span class="comment">// [xsp+50h] [xbp-20h] BYREF</span></span><br><span class="line">  __int64 v7; <span class="comment">// [xsp+68h] [xbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = *(_QWORD *)(_ReadStatusReg(ARM64_SYSREG(<span class="number">3</span>, <span class="number">3</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">2</span>)) + <span class="number">40</span>);</span><br><span class="line">  sub_3FE20(a1, a3, (__int64)v6);<span class="comment">//复制字符串</span></span><br><span class="line">  <span class="keyword">if</span> ( sub_40040((__int64)v6) == <span class="number">8</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">6</span>; ++i )</span><br><span class="line">      byte_C80E0[i] = *(_BYTE *)sub_40064((__int64)v6, i);</span><br><span class="line">    v5 = sub_3ED8C((<span class="type">unsigned</span> <span class="type">int</span> *)byte_C80E0);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v5 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_3FC04((__int64)v6);</span><br><span class="line">  _ReadStatusReg(ARM64_SYSREG(<span class="number">3</span>, <span class="number">3</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">2</span>));</span><br><span class="line">  <span class="keyword">return</span> v5;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>为啥反编译不一样</p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://cdn.jsdelivr.net/gh/runwu2204/Blog_imgs/202306231819094.png"                      alt="image-20230623181955999"                ></p><div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">bool __fastcall <span class="title function_">sub_3ED8C</span><span class="params">(unsigned <span class="type">int</span> *a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  unsigned <span class="type">int</span> i; <span class="comment">// [xsp+20h] [xbp-20h]</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// [xsp+24h] [xbp-1Ch]</span></span><br><span class="line">  unsigned <span class="type">int</span> v4; <span class="comment">// [xsp+28h] [xbp-18h]</span></span><br><span class="line">  unsigned <span class="type">int</span> v5; <span class="comment">// [xsp+2Ch] [xbp-14h]</span></span><br><span class="line"></span><br><span class="line">  v5 = *a1;</span><br><span class="line">  v4 = a1[<span class="number">1</span>];</span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">0x20</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 += dword_C8010;</span><br><span class="line">    v5 += (<span class="number">16</span> * v4 + dword_C8000) ^ (v4 + v3) ^ ((v4 &gt;&gt; <span class="number">5</span>) + dword_C8004);</span><br><span class="line">    v4 += (<span class="number">16</span> * v5 + dword_C8008) ^ (v5 + v3) ^ ((v5 &gt;&gt; <span class="number">5</span>) + dword_C800C);</span><br><span class="line">  &#125;</span><br><span class="line">  *a1 = v5;</span><br><span class="line">  a1[<span class="number">1</span>] = v4;</span><br><span class="line">  <span class="keyword">return</span> *a1 == <span class="number">0xF5A98FF3</span> &amp;&amp; a1[<span class="number">1</span>] == <span class="number">0xA21873A3</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>通过交叉引用发现有对key的修改key为{9,7,8,6}</p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://cdn.jsdelivr.net/gh/runwu2204/Blog_imgs/202306231822092.png"                      alt="image-20230623182220976"                ></p><div class="highlight-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">sub_3EF18</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  dword_C8004 = <span class="number">7</span>;</span><br><span class="line">  dword_C8008 = <span class="number">8</span>;</span><br><span class="line">  dword_C800C = <span class="number">6</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>有个自启动的函数对值进行修改，自启动的一般都在.init_array表内</p><div class="highlight-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.init_array:<span class="number">00000000000</span>C0F98 ; Segment type: Pure data</span><br><span class="line">.init_array:<span class="number">00000000000</span>C0F98                 AREA .init_array, DATA, ALIGN=<span class="number">3</span></span><br><span class="line">.init_array:<span class="number">00000000000</span>C0F98                 ; ORG <span class="number">0xC0F98</span></span><br><span class="line">.init_array:<span class="number">00000000000</span>C0F98 off_C0F98       DCQ sub_3EF3C           ; DATA XREF: LOAD:<span class="number">0000000000000088</span>↑o</span><br><span class="line">.init_array:<span class="number">00000000000</span>C0F98                                         ; LOAD:<span class="number">00000000000001</span>D8↑o</span><br><span class="line">.init_array:<span class="number">00000000000</span>C0F98 ; .init_array   ends</span><br><span class="line">.init_array:<span class="number">00000000000</span>C0F98</span><br></pre></td></tr></table></figure></div><p>直接用之前写的tea算法</p><div class="highlight-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">teajiami</span> <span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> <span class="comment">//此处uint32长度就为usigned int占32bit共4个字节</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> sum = <span class="number">0</span>;  <span class="comment">// 注意sum也是32位无符号整型</span></span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>];</span><br><span class="line">    <span class="type">uint32_t</span> delta = <span class="number">0x458BCD42</span>;</span><br><span class="line">    <span class="type">uint32_t</span> k0 = k[<span class="number">0</span>], k1 = k[<span class="number">1</span>], k2 = k[<span class="number">2</span>], k3 = k[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++) <span class="comment">//进行32轮迭代，次数越多越难破解，但同时效率也会降低</span></span><br><span class="line">    &#123;</span><br><span class="line">        sum += delta;</span><br><span class="line">        v0 += ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        v1 += ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    v[<span class="number">0</span>]=v0; </span><br><span class="line">    v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">teajiemi</span> <span class="params">(<span class="type">uint32_t</span>* v, <span class="type">uint32_t</span>* k)</span> <span class="comment">//解密也是进行相同的异或操作，通过异或同一个数恢复原数</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>];</span><br><span class="line">    <span class="type">uint32_t</span> delta = <span class="number">0x458BCD42</span>;</span><br><span class="line">    <span class="type">uint32_t</span> sum = delta * <span class="number">32</span>;</span><br><span class="line">    <span class="type">uint32_t</span> k0 = k[<span class="number">0</span>], k1 = k[<span class="number">1</span>], k2 = k[<span class="number">2</span>], k3 = k[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++) &#123;</span><br><span class="line">        v1 -= ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">        v0 -= ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        sum -= delta;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    v[<span class="number">0</span>]=v0; </span><br><span class="line">    v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// test</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 两个32位无符号整数，即待加密的64bit明文数据</span></span><br><span class="line">    <span class="type">uint32_t</span> v[<span class="number">2</span>] = &#123;<span class="number">0xF5A98FF3</span>, <span class="number">0xA21873A3</span>&#125;;</span><br><span class="line">    <span class="comment">// 四个32位无符号整数，即128bit的key</span></span><br><span class="line">    <span class="type">uint32_t</span> k[<span class="number">4</span>]= &#123;<span class="number">0x9</span>, <span class="number">0x7</span>, <span class="number">0x8</span>, <span class="number">0x6</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// printf(&quot;Data is : %x %x\n&quot;, v[0], v[1]);</span></span><br><span class="line">    <span class="comment">// teajiami(v, k);</span></span><br><span class="line">    <span class="comment">// printf(&quot;Encrypted data is : %x %x\n&quot;, v[0], v[1]);</span></span><br><span class="line">    teajiemi(v, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Decrypted data is : %x %x\n&quot;</span>, v[<span class="number">0</span>], v[<span class="number">1</span>]);</span><br><span class="line"><span class="built_in">puts</span>((<span class="type">char</span>*)v);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://cdn.jsdelivr.net/gh/runwu2204/Blog_imgs/202306231838820.png"                      alt="image-20230623183849786"                ></p><p>直接用md5</p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://cdn.jsdelivr.net/gh/runwu2204/Blog_imgs/202306231839145.png"                      alt="image-20230623183945049"                ></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;参考wp[(41条消息) BUUCTF &lt;a class=&quot;link&quot;   href=&quot;https://blog.csdn.net/weixin_53349587/article/details/122394778&quot; &gt;GKCTF 2021]app-debug_皮皮蟹！的博</summary>
      
    
    
    
    <category term="CTF WP" scheme="http://example.com/categories/CTF-WP/"/>
    
    <category term="Re" scheme="http://example.com/categories/CTF-WP/Re/"/>
    
    <category term="安卓" scheme="http://example.com/categories/CTF-WP/Re/%E5%AE%89%E5%8D%93/"/>
    
    
  </entry>
  
  <entry>
    <title>SCTF2023 checkin</title>
    <link href="http://example.com/2023/06/23/CTF%20WP/Misc/SCTF2023%20checkin/"/>
    <id>http://example.com/2023/06/23/CTF%20WP/Misc/SCTF2023%20checkin/</id>
    <published>2023-06-22T17:31:16.000Z</published>
    <updated>2023-06-22T17:40:56.000Z</updated>
    
    <content type="html"><![CDATA[<p>点击通过资源管理器打开</p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://cdn.jsdelivr.net/gh/runwu2204/Blog_imgs/202306230140213.png"                      alt="image-20230623014043149"                ></p><p>点击全部解压缩</p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://cdn.jsdelivr.net/gh/runwu2204/Blog_imgs/202306230133029.png"                      alt="image-20230623013317976"                ></p><p>会出现一个重名的文件，直接跳过</p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://cdn.jsdelivr.net/gh/runwu2204/Blog_imgs/202306230133086.png"                      alt="image-20230623013345054"                ></p><p>直接跳过，查看那个文件就会有flag了，具体原因猜测是原zip中放了个压缩后的压缩包，无法被正常识别</p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://cdn.jsdelivr.net/gh/runwu2204/Blog_imgs/202306230134086.png"                      alt="image-20230623013445052"                ></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;点击通过资源管理器打开&lt;/p&gt;
&lt;p&gt;&lt;img  
                     lazyload
                     src=&quot;/images/loading.svg&quot;
                     data-src=&quot;htt</summary>
      
    
    
    
    <category term="CTF WP" scheme="http://example.com/categories/CTF-WP/"/>
    
    <category term="Misc" scheme="http://example.com/categories/CTF-WP/Misc/"/>
    
    
  </entry>
  
  <entry>
    <title>鹤城杯 2021designEachStep</title>
    <link href="http://example.com/2023/06/22/CTF%20WP/Re/%E5%AE%89%E5%8D%93/%E9%B9%A4%E5%9F%8E%E6%9D%AF%202021designEachStep/"/>
    <id>http://example.com/2023/06/22/CTF%20WP/Re/%E5%AE%89%E5%8D%93/%E9%B9%A4%E5%9F%8E%E6%9D%AF%202021designEachStep/</id>
    <published>2023-06-22T14:46:05.000Z</published>
    <updated>2023-06-22T16:10:57.000Z</updated>
    
    <content type="html"><![CDATA[<p>只有一个activity组件</p><div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> <span class="attr">android:versionCode</span>=<span class="string">&quot;1&quot;</span> <span class="attr">android:versionName</span>=<span class="string">&quot;1.0&quot;</span> <span class="attr">android:compileSdkVersion</span>=<span class="string">&quot;30&quot;</span> <span class="attr">android:compileSdkVersionCodename</span>=<span class="string">&quot;11&quot;</span> <span class="attr">package</span>=<span class="string">&quot;com.test.designeachstep&quot;</span> <span class="attr">platformBuildVersionCode</span>=<span class="string">&quot;30&quot;</span> <span class="attr">platformBuildVersionName</span>=<span class="string">&quot;11&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-sdk</span> <span class="attr">android:minSdkVersion</span>=<span class="string">&quot;21&quot;</span> <span class="attr">android:targetSdkVersion</span>=<span class="string">&quot;30&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">application</span> <span class="attr">android:theme</span>=<span class="string">&quot;@style/Theme.DesignEachStep&quot;</span> <span class="attr">android:label</span>=<span class="string">&quot;@string/app_name&quot;</span> <span class="attr">android:icon</span>=<span class="string">&quot;@mipmap/ic_launcher&quot;</span> <span class="attr">android:allowBackup</span>=<span class="string">&quot;true&quot;</span> <span class="attr">android:supportsRtl</span>=<span class="string">&quot;true&quot;</span> <span class="attr">android:roundIcon</span>=<span class="string">&quot;@mipmap/ic_launcher_round&quot;</span> <span class="attr">android:appComponentFactory</span>=<span class="string">&quot;androidx.core.app.CoreComponentFactory&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">&quot;com.test.designeachstep.MainActivity&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.action.MAIN&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.category.LAUNCHER&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p>有一个按钮触发事件（非常长）</p><div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">View$OnClickListenerC1003a</span> <span class="keyword">implements</span> <span class="title class_">View</span>.OnClickListener &#123;</span><br><span class="line">        <span class="keyword">public</span> View$OnClickListenerC1003a() &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* JADX WARN: Removed duplicated region for block: B:34:0x00af  */</span></span><br><span class="line">        <span class="comment">/* JADX WARN: Removed duplicated region for block: B:36:0x00bb  */</span></span><br><span class="line">        <span class="comment">/* JADX WARN: Removed duplicated region for block: B:76:0x0143  */</span></span><br><span class="line">        <span class="comment">/* JADX WARN: Removed duplicated region for block: B:78:0x014f  */</span></span><br><span class="line">        <span class="meta">@Override</span> <span class="comment">// android.view.View.OnClickListener</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            Code decompiled incorrectly, please refer to instructions dump.</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">            <span class="type">byte</span>[] bArr;</span><br><span class="line">            <span class="type">byte</span>[] bArr2;</span><br><span class="line">            <span class="type">byte</span>[] byteArray;</span><br><span class="line">            <span class="type">byte</span>[] bArr3;</span><br><span class="line">            <span class="type">byte</span>[] byteArray2;</span><br><span class="line">            <span class="type">String</span> <span class="variable">obj</span> <span class="operator">=</span> MainActivity.<span class="built_in">this</span>.f3918o.getText().toString();</span><br><span class="line">            <span class="keyword">if</span> (obj.length() != <span class="number">24</span>) &#123;</span><br><span class="line">                Toast.makeText(MainActivity.<span class="built_in">this</span>, <span class="string">&quot;Nono, try again please&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">byte</span>[] bytes = obj.getBytes();</span><br><span class="line">            <span class="type">byte</span>[] bArr4 = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">8</span>];</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">DataInputStream</span> <span class="variable">dataInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DataInputStream</span>(MainActivity.<span class="built_in">this</span>.getAssets().open(<span class="string">&quot;data.bin&quot;</span>));</span><br><span class="line">                <span class="type">byte</span>[] bArr5 = <span class="keyword">new</span> <span class="title class_">byte</span>[dataInputStream.available()];</span><br><span class="line">                dataInputStream.readFully(bArr5);</span><br><span class="line">                System.arraycopy(bytes, <span class="number">0</span>, bArr4, <span class="number">0</span>, <span class="number">8</span>);</span><br><span class="line">                <span class="type">ByteArrayOutputStream</span> <span class="variable">byteArrayOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">                <span class="type">byte</span>[] bArr6 = <span class="literal">null</span>;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="type">GZIPInputStream</span> <span class="variable">gZIPInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GZIPInputStream</span>(<span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(bArr5));</span><br><span class="line">                    <span class="type">byte</span>[] bArr7 = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">256</span>];</span><br><span class="line">                    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                        <span class="type">int</span> <span class="variable">read</span> <span class="operator">=</span> gZIPInputStream.read(bArr7);</span><br><span class="line">                        <span class="keyword">if</span> (read &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        byteArrayOutputStream.write(bArr7, <span class="number">0</span>, read);</span><br><span class="line">                    &#125;</span><br><span class="line">                    byteArray2 = byteArrayOutputStream.toByteArray();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException unused) &#123;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (byteArray2.length &gt;= <span class="number">8</span>) &#123;</span><br><span class="line">                    <span class="type">byte</span>[] bArr8 = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">8</span>];</span><br><span class="line">                    System.arraycopy(byteArray2, <span class="number">0</span>, bArr8, <span class="number">0</span>, <span class="number">8</span>);</span><br><span class="line">                    <span class="type">byte</span>[] bArr9 = <span class="keyword">new</span> <span class="title class_">byte</span>[byteArray2.length - <span class="number">8</span>];</span><br><span class="line">                    System.arraycopy(byteArray2, <span class="number">8</span>, bArr9, <span class="number">0</span>, byteArray2.length - <span class="number">8</span>);</span><br><span class="line">                    <span class="keyword">if</span> (Arrays.equals(bArr8, bArr4)) &#123;</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            <span class="type">Cipher</span> <span class="variable">cipher</span> <span class="operator">=</span> Cipher.getInstance(<span class="string">&quot;DES&quot;</span>);</span><br><span class="line">                            cipher.init(<span class="number">2</span>, C0766a.m422j(bArr4));</span><br><span class="line">                            bArr = cipher.doFinal(bArr9);</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (InvalidKeyException e) &#123;</span><br><span class="line">                            e.printStackTrace();</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException e2) &#123;</span><br><span class="line">                            e2.printStackTrace();</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (BadPaddingException e3) &#123;</span><br><span class="line">                            e3.printStackTrace();</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (IllegalBlockSizeException e4) &#123;</span><br><span class="line">                            e4.printStackTrace();</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (NoSuchPaddingException e5) &#123;</span><br><span class="line">                            e5.printStackTrace();</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">if</span> (bArr != <span class="literal">null</span>) &#123;</span><br><span class="line">                            Toast.makeText(MainActivity.<span class="built_in">this</span>, <span class="string">&quot;The first step incorrect, try again please&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                            <span class="keyword">return</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        System.arraycopy(bytes, <span class="number">8</span>, bArr4, <span class="number">0</span>, <span class="number">8</span>);</span><br><span class="line">                        <span class="type">Inflater</span> <span class="variable">inflater</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Inflater</span>();</span><br><span class="line">                        inflater.setInput(bArr);</span><br><span class="line">                        <span class="type">ByteArrayOutputStream</span> <span class="variable">byteArrayOutputStream2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>(bArr.length);</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            <span class="keyword">try</span> &#123;</span><br><span class="line">                                <span class="type">byte</span>[] bArr10 = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">                                <span class="keyword">while</span> (!inflater.finished()) &#123;</span><br><span class="line">                                    byteArrayOutputStream2.write(bArr10, <span class="number">0</span>, inflater.inflate(bArr10));</span><br><span class="line">                                &#125;</span><br><span class="line">                                <span class="keyword">try</span> &#123;</span><br><span class="line">                                    byteArrayOutputStream2.close();</span><br><span class="line">                                &#125; <span class="keyword">catch</span> (IOException e6) &#123;</span><br><span class="line">                                    e6.printStackTrace();</span><br><span class="line">                                &#125;</span><br><span class="line">                                inflater.end();</span><br><span class="line">                                byteArray = byteArrayOutputStream2.toByteArray();</span><br><span class="line">                            &#125; <span class="keyword">catch</span> (Throwable th) &#123;</span><br><span class="line">                                <span class="keyword">try</span> &#123;</span><br><span class="line">                                    byteArrayOutputStream2.close();</span><br><span class="line">                                &#125; <span class="keyword">catch</span> (IOException e7) &#123;</span><br><span class="line">                                    e7.printStackTrace();</span><br><span class="line">                                &#125;</span><br><span class="line">                                <span class="keyword">throw</span> th;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (Exception e8) &#123;</span><br><span class="line">                            e8.printStackTrace();</span><br><span class="line">                            <span class="keyword">try</span> &#123;</span><br><span class="line">                                byteArrayOutputStream2.close();</span><br><span class="line">                            &#125; <span class="keyword">catch</span> (IOException e9) &#123;</span><br><span class="line">                                e9.printStackTrace();</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">if</span> (byteArray.length &gt;= <span class="number">8</span>) &#123;</span><br><span class="line">                            <span class="type">byte</span>[] bArr11 = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">8</span>];</span><br><span class="line">                            System.arraycopy(byteArray, <span class="number">0</span>, bArr11, <span class="number">0</span>, <span class="number">8</span>);</span><br><span class="line">                            <span class="type">byte</span>[] bArr12 = <span class="keyword">new</span> <span class="title class_">byte</span>[byteArray.length - <span class="number">8</span>];</span><br><span class="line">                            System.arraycopy(byteArray, <span class="number">8</span>, bArr12, <span class="number">0</span>, byteArray.length - <span class="number">8</span>);</span><br><span class="line">                            <span class="keyword">if</span> (Arrays.equals(bArr11, bArr4)) &#123;</span><br><span class="line">                                <span class="keyword">try</span> &#123;</span><br><span class="line">                                    <span class="type">Cipher</span> <span class="variable">cipher2</span> <span class="operator">=</span> Cipher.getInstance(<span class="string">&quot;DES&quot;</span>);</span><br><span class="line">                                    cipher2.init(<span class="number">2</span>, C0766a.m422j(bArr4));</span><br><span class="line">                                    bArr3 = cipher2.doFinal(bArr12);</span><br><span class="line">                                &#125; <span class="keyword">catch</span> (InvalidKeyException e10) &#123;</span><br><span class="line">                                    e10.printStackTrace();</span><br><span class="line">                                    bArr3 = <span class="literal">null</span>;</span><br><span class="line">                                    bArr2 = bArr3;</span><br><span class="line">                                    <span class="keyword">if</span> (bArr2 == <span class="literal">null</span>) &#123;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException e11) &#123;</span><br><span class="line">                                    e11.printStackTrace();</span><br><span class="line">                                    bArr3 = <span class="literal">null</span>;</span><br><span class="line">                                    bArr2 = bArr3;</span><br><span class="line">                                    <span class="keyword">if</span> (bArr2 == <span class="literal">null</span>) &#123;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125; <span class="keyword">catch</span> (BadPaddingException e12) &#123;</span><br><span class="line">                                    e12.printStackTrace();</span><br><span class="line">                                    bArr3 = <span class="literal">null</span>;</span><br><span class="line">                                    bArr2 = bArr3;</span><br><span class="line">                                    <span class="keyword">if</span> (bArr2 == <span class="literal">null</span>) &#123;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125; <span class="keyword">catch</span> (IllegalBlockSizeException e13) &#123;</span><br><span class="line">                                    e13.printStackTrace();</span><br><span class="line">                                    bArr3 = <span class="literal">null</span>;</span><br><span class="line">                                    bArr2 = bArr3;</span><br><span class="line">                                    <span class="keyword">if</span> (bArr2 == <span class="literal">null</span>) &#123;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125; <span class="keyword">catch</span> (NoSuchPaddingException e14) &#123;</span><br><span class="line">                                    e14.printStackTrace();</span><br><span class="line">                                    bArr3 = <span class="literal">null</span>;</span><br><span class="line">                                    bArr2 = bArr3;</span><br><span class="line">                                    <span class="keyword">if</span> (bArr2 == <span class="literal">null</span>) &#123;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;</span><br><span class="line">                                bArr2 = bArr3;</span><br><span class="line">                                <span class="keyword">if</span> (bArr2 == <span class="literal">null</span>) &#123;</span><br><span class="line">                                    Toast.makeText(MainActivity.<span class="built_in">this</span>, <span class="string">&quot;The first step has been taken, try again please&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                                    <span class="keyword">return</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                                System.arraycopy(bytes, <span class="number">16</span>, bArr4, <span class="number">0</span>, <span class="number">8</span>);</span><br><span class="line">                                <span class="type">LZ4SafeDecompressor</span> <span class="variable">safeDecompressor</span> <span class="operator">=</span> LZ4Factory.safeInstance().safeDecompressor();</span><br><span class="line">                                <span class="type">byte</span>[] bArr13 = <span class="keyword">new</span> <span class="title class_">byte</span>[bArr2.length * <span class="number">5</span>];</span><br><span class="line">                                <span class="type">int</span> <span class="variable">decompress</span> <span class="operator">=</span> safeDecompressor.decompress(bArr2, <span class="number">0</span>, bArr2.length, bArr13, <span class="number">0</span>);</span><br><span class="line">                                <span class="type">byte</span>[] bArr14 = <span class="keyword">new</span> <span class="title class_">byte</span>[decompress];</span><br><span class="line">                                System.arraycopy(bArr13, <span class="number">0</span>, bArr14, <span class="number">0</span>, decompress);</span><br><span class="line">                                <span class="keyword">if</span> (decompress &gt;= <span class="number">8</span>) &#123;</span><br><span class="line">                                    <span class="type">byte</span>[] bArr15 = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">8</span>];</span><br><span class="line">                                    System.arraycopy(bArr14, <span class="number">0</span>, bArr15, <span class="number">0</span>, <span class="number">8</span>);</span><br><span class="line">                                    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> decompress - <span class="number">8</span>;</span><br><span class="line">                                    <span class="type">byte</span>[] bArr16 = <span class="keyword">new</span> <span class="title class_">byte</span>[i];</span><br><span class="line">                                    System.arraycopy(bArr14, <span class="number">8</span>, bArr16, <span class="number">0</span>, i);</span><br><span class="line">                                    <span class="keyword">if</span> (Arrays.equals(bArr15, bArr4)) &#123;</span><br><span class="line">                                        <span class="keyword">try</span> &#123;</span><br><span class="line">                                            <span class="type">Cipher</span> <span class="variable">cipher3</span> <span class="operator">=</span> Cipher.getInstance(<span class="string">&quot;DES&quot;</span>);</span><br><span class="line">                                            cipher3.init(<span class="number">2</span>, C0766a.m422j(bArr4));</span><br><span class="line">                                            bArr6 = cipher3.doFinal(bArr16);</span><br><span class="line">                                        &#125; <span class="keyword">catch</span> (InvalidKeyException e15) &#123;</span><br><span class="line">                                            e15.printStackTrace();</span><br><span class="line">                                        &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException e16) &#123;</span><br><span class="line">                                            e16.printStackTrace();</span><br><span class="line">                                        &#125; <span class="keyword">catch</span> (BadPaddingException e17) &#123;</span><br><span class="line">                                            e17.printStackTrace();</span><br><span class="line">                                        &#125; <span class="keyword">catch</span> (IllegalBlockSizeException e18) &#123;</span><br><span class="line">                                            e18.printStackTrace();</span><br><span class="line">                                        &#125; <span class="keyword">catch</span> (NoSuchPaddingException e19) &#123;</span><br><span class="line">                                            e19.printStackTrace();</span><br><span class="line">                                        &#125;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;</span><br><span class="line">                                <span class="type">MainActivity</span> <span class="variable">mainActivity</span> <span class="operator">=</span> MainActivity.<span class="built_in">this</span>;</span><br><span class="line">                                <span class="keyword">if</span> (bArr6 == <span class="literal">null</span>) &#123;</span><br><span class="line">                                    Toast.makeText(mainActivity, <span class="string">&quot;Almost succeeded, try again please&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                                    <span class="keyword">return</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                                Toast.makeText(mainActivity, <span class="string">&quot;Each step is correct, Congs!&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                                MainActivity.<span class="built_in">this</span>.f3919p.setImageBitmap(BitmapFactory.decodeByteArray(bArr6, <span class="number">0</span>, bArr6.length));</span><br><span class="line">                                <span class="keyword">return</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        bArr2 = <span class="literal">null</span>;</span><br><span class="line">                        <span class="keyword">if</span> (bArr2 == <span class="literal">null</span>) &#123;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                bArr = <span class="literal">null</span>;</span><br><span class="line">                <span class="keyword">if</span> (bArr != <span class="literal">null</span>) &#123;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e20) &#123;</span><br><span class="line">                Toast.makeText(MainActivity.<span class="built_in">this</span>, <span class="string">&quot;Get data error&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                e20.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><p>有一个解压的操作里面有第一个8个字节密钥</p><div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"><span class="type">GZIPInputStream</span> <span class="variable">gZIPInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GZIPInputStream</span>(<span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(bArr5));</span><br><span class="line"><span class="type">byte</span>[] bArr7 = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">256</span>];</span><br><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">read</span> <span class="operator">=</span> gZIPInputStream.read(bArr7);</span><br><span class="line"><span class="keyword">if</span> (read &lt; <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">byteArrayOutputStream.write(bArr7, <span class="number">0</span>, read);</span><br><span class="line">&#125;<span class="comment">//直接将解压后的读入输出流中</span></span><br><span class="line">byteArray2 = byteArrayOutputStream.toByteArray();<span class="comment">//将输出流的数据转化为byte数组</span></span><br><span class="line">&#125; <span class="keyword">catch</span> (IOException unused) &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><p>后面跟着一个解密操作和一个Inflater解压缩</p><div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (byteArray2.length &gt;= <span class="number">8</span>) &#123;</span><br><span class="line">                    <span class="type">byte</span>[] bArr8 = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">8</span>];</span><br><span class="line">                    System.arraycopy(byteArray2, <span class="number">0</span>, bArr8, <span class="number">0</span>, <span class="number">8</span>);</span><br><span class="line">                    <span class="type">byte</span>[] bArr9 = <span class="keyword">new</span> <span class="title class_">byte</span>[byteArray2.length - <span class="number">8</span>];</span><br><span class="line">                    System.arraycopy(byteArray2, <span class="number">8</span>, bArr9, <span class="number">0</span>, byteArray2.length - <span class="number">8</span>);</span><br><span class="line">                    <span class="keyword">if</span> (Arrays.equals(bArr8, bArr4)) &#123;</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            <span class="type">Cipher</span> <span class="variable">cipher</span> <span class="operator">=</span> Cipher.getInstance(<span class="string">&quot;DES&quot;</span>);</span><br><span class="line">                            cipher.init(<span class="number">2</span>, C0766a.m422j(bArr4));</span><br><span class="line">                            bArr = cipher.doFinal(bArr9);</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (InvalidKeyException e) &#123;</span><br><span class="line">                            e.printStackTrace();</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException e2) &#123;</span><br><span class="line">                            e2.printStackTrace();</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (BadPaddingException e3) &#123;</span><br><span class="line">                            e3.printStackTrace();</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (IllegalBlockSizeException e4) &#123;</span><br><span class="line">                            e4.printStackTrace();</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (NoSuchPaddingException e5) &#123;</span><br><span class="line">                            e5.printStackTrace();</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">if</span> (bArr != <span class="literal">null</span>) &#123;</span><br><span class="line">                            Toast.makeText(MainActivity.<span class="built_in">this</span>, <span class="string">&quot;The first step incorrect, try again please&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                            <span class="keyword">return</span>;</span><br><span class="line">                        &#125;<span class="comment">//不知道为啥此处会校验bArr是否不等于null，解密成功才会进入？这样不符合逻辑了</span></span><br><span class="line">                        System.arraycopy(bytes, <span class="number">8</span>, bArr4, <span class="number">0</span>, <span class="number">8</span>);</span><br><span class="line">                        <span class="type">Inflater</span> <span class="variable">inflater</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Inflater</span>();</span><br><span class="line">                        inflater.setInput(bArr);</span><br><span class="line">                        <span class="type">ByteArrayOutputStream</span> <span class="variable">byteArrayOutputStream2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>(bArr.length);</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            <span class="keyword">try</span> &#123;</span><br><span class="line">                                <span class="type">byte</span>[] bArr10 = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">                                <span class="keyword">while</span> (!inflater.finished()) &#123;</span><br><span class="line">                                    byteArrayOutputStream2.write(bArr10, <span class="number">0</span>, inflater.inflate(bArr10));</span><br><span class="line">                                &#125;</span><br><span class="line">                                <span class="keyword">try</span> &#123;</span><br><span class="line">                                    byteArrayOutputStream2.close();</span><br><span class="line">                                &#125; <span class="keyword">catch</span> (IOException e6) &#123;</span><br><span class="line">                                    e6.printStackTrace();</span><br><span class="line">                                &#125;</span><br><span class="line">                                inflater.end();</span><br><span class="line">                                byteArray = byteArrayOutputStream2.toByteArray();</span><br><span class="line">                            &#125; <span class="keyword">catch</span> (Throwable th) &#123;</span><br><span class="line">                                <span class="keyword">try</span> &#123;</span><br><span class="line">                                    byteArrayOutputStream2.close();</span><br><span class="line">                                &#125; <span class="keyword">catch</span> (IOException e7) &#123;</span><br><span class="line">                                    e7.printStackTrace();</span><br><span class="line">                                &#125;</span><br><span class="line">                                <span class="keyword">throw</span> th;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (Exception e8) &#123;</span><br><span class="line">                            e8.printStackTrace();</span><br><span class="line">                            <span class="keyword">try</span> &#123;</span><br><span class="line">                                byteArrayOutputStream2.close();</span><br><span class="line">                            &#125; <span class="keyword">catch</span> (IOException e9) &#123;</span><br><span class="line">                                e9.printStackTrace();</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><p>又跟了一个解密这次是中间的8个字节密钥</p><div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (byteArray.length &gt;= <span class="number">8</span>) &#123;</span><br><span class="line">                            <span class="type">byte</span>[] bArr11 = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">8</span>];</span><br><span class="line">                            System.arraycopy(byteArray, <span class="number">0</span>, bArr11, <span class="number">0</span>, <span class="number">8</span>);</span><br><span class="line">                            <span class="type">byte</span>[] bArr12 = <span class="keyword">new</span> <span class="title class_">byte</span>[byteArray.length - <span class="number">8</span>];</span><br><span class="line">                            System.arraycopy(byteArray, <span class="number">8</span>, bArr12, <span class="number">0</span>, byteArray.length - <span class="number">8</span>);</span><br><span class="line">                            <span class="keyword">if</span> (Arrays.equals(bArr11, bArr4)) &#123;</span><br><span class="line">                                <span class="keyword">try</span> &#123;</span><br><span class="line">                                    <span class="type">Cipher</span> <span class="variable">cipher2</span> <span class="operator">=</span> Cipher.getInstance(<span class="string">&quot;DES&quot;</span>);</span><br><span class="line">                                    cipher2.init(<span class="number">2</span>, C0766a.m422j(bArr4));</span><br><span class="line">                                    bArr3 = cipher2.doFinal(bArr12);</span><br><span class="line">                                &#125; <span class="keyword">catch</span> (InvalidKeyException e10) &#123;</span><br><span class="line">                                    e10.printStackTrace();</span><br><span class="line">                                    bArr3 = <span class="literal">null</span>;</span><br><span class="line">                                    bArr2 = bArr3;</span><br><span class="line">                                    <span class="keyword">if</span> (bArr2 == <span class="literal">null</span>) &#123;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException e11) &#123;</span><br><span class="line">                                    e11.printStackTrace();</span><br><span class="line">                                    bArr3 = <span class="literal">null</span>;</span><br><span class="line">                                    bArr2 = bArr3;</span><br><span class="line">                                    <span class="keyword">if</span> (bArr2 == <span class="literal">null</span>) &#123;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125; <span class="keyword">catch</span> (BadPaddingException e12) &#123;</span><br><span class="line">                                    e12.printStackTrace();</span><br><span class="line">                                    bArr3 = <span class="literal">null</span>;</span><br><span class="line">                                    bArr2 = bArr3;</span><br><span class="line">                                    <span class="keyword">if</span> (bArr2 == <span class="literal">null</span>) &#123;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125; <span class="keyword">catch</span> (IllegalBlockSizeException e13) &#123;</span><br><span class="line">                                    e13.printStackTrace();</span><br><span class="line">                                    bArr3 = <span class="literal">null</span>;</span><br><span class="line">                                    bArr2 = bArr3;</span><br><span class="line">                                    <span class="keyword">if</span> (bArr2 == <span class="literal">null</span>) &#123;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125; <span class="keyword">catch</span> (NoSuchPaddingException e14) &#123;</span><br><span class="line">                                    e14.printStackTrace();</span><br><span class="line">                                    bArr3 = <span class="literal">null</span>;</span><br><span class="line">                                    bArr2 = bArr3;</span><br><span class="line">                                    <span class="keyword">if</span> (bArr2 == <span class="literal">null</span>) &#123;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;</span><br><span class="line">                                bArr2 = bArr3;</span><br><span class="line">                                <span class="keyword">if</span> (bArr2 == <span class="literal">null</span>) &#123;</span><br><span class="line">                                    Toast.makeText(MainActivity.<span class="built_in">this</span>, <span class="string">&quot;The first step has been taken, try again please&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                                    <span class="keyword">return</span>;</span><br><span class="line">                                &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><p>最后有最后的8个密钥和一个LZ4解压缩（IDEA抽风了，包下了半天才出来）</p><div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">System.arraycopy(bytes, <span class="number">16</span>, bArr4, <span class="number">0</span>, <span class="number">8</span>);</span><br><span class="line">                                <span class="type">LZ4SafeDecompressor</span> <span class="variable">safeDecompressor</span> <span class="operator">=</span> LZ4Factory.safeInstance().safeDecompressor();</span><br><span class="line">                                <span class="type">byte</span>[] bArr13 = <span class="keyword">new</span> <span class="title class_">byte</span>[bArr2.length * <span class="number">5</span>];</span><br><span class="line">                                <span class="type">int</span> <span class="variable">decompress</span> <span class="operator">=</span> safeDecompressor.decompress(bArr2, <span class="number">0</span>, bArr2.length, bArr13, <span class="number">0</span>);</span><br><span class="line">                                <span class="type">byte</span>[] bArr14 = <span class="keyword">new</span> <span class="title class_">byte</span>[decompress];</span><br><span class="line">                                System.arraycopy(bArr13, <span class="number">0</span>, bArr14, <span class="number">0</span>, decompress);</span><br><span class="line">                                <span class="keyword">if</span> (decompress &gt;= <span class="number">8</span>) &#123;</span><br><span class="line">                                    <span class="type">byte</span>[] bArr15 = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">8</span>];</span><br><span class="line">                                    System.arraycopy(bArr14, <span class="number">0</span>, bArr15, <span class="number">0</span>, <span class="number">8</span>);</span><br><span class="line">                                    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> decompress - <span class="number">8</span>;</span><br><span class="line">                                    <span class="type">byte</span>[] bArr16 = <span class="keyword">new</span> <span class="title class_">byte</span>[i];</span><br><span class="line">                                    System.arraycopy(bArr14, <span class="number">8</span>, bArr16, <span class="number">0</span>, i);</span><br><span class="line">                                    <span class="keyword">if</span> (Arrays.equals(bArr15, bArr4)) &#123;</span><br><span class="line">                                        <span class="keyword">try</span> &#123;</span><br><span class="line">                                            <span class="type">Cipher</span> <span class="variable">cipher3</span> <span class="operator">=</span> Cipher.getInstance(<span class="string">&quot;DES&quot;</span>);</span><br><span class="line">                                            cipher3.init(<span class="number">2</span>, C0766a.m422j(bArr4));</span><br><span class="line">                                            bArr6 = cipher3.doFinal(bArr16);</span><br><span class="line">                                        &#125; <span class="keyword">catch</span> (InvalidKeyException e15) &#123;</span><br><span class="line">                                            e15.printStackTrace();</span><br><span class="line">                                        &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException e16) &#123;</span><br><span class="line">                                            e16.printStackTrace();</span><br><span class="line">                                        &#125; <span class="keyword">catch</span> (BadPaddingException e17) &#123;</span><br><span class="line">                                            e17.printStackTrace();</span><br><span class="line">                                        &#125; <span class="keyword">catch</span> (IllegalBlockSizeException e18) &#123;</span><br><span class="line">                                            e18.printStackTrace();</span><br><span class="line">                                        &#125; <span class="keyword">catch</span> (NoSuchPaddingException e19) &#123;</span><br><span class="line">                                            e19.printStackTrace();</span><br><span class="line">                                        &#125;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;</span><br><span class="line">                                <span class="type">MainActivity</span> <span class="variable">mainActivity</span> <span class="operator">=</span> MainActivity.<span class="built_in">this</span>;</span><br><span class="line">                                <span class="keyword">if</span> (bArr6 == <span class="literal">null</span>) &#123;</span><br><span class="line">                                    Toast.makeText(mainActivity, <span class="string">&quot;Almost succeeded, try again please&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                                    <span class="keyword">return</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                                Toast.makeText(mainActivity, <span class="string">&quot;Each step is correct, Congs!&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                                MainActivity.<span class="built_in">this</span>.f3919p.setImageBitmap(BitmapFactory.decodeByteArray(bArr6, <span class="number">0</span>, bArr6.length));</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><p>最后根据代码逻辑推出的解密exp</p><div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"><span class="keyword">import</span> net.jpountz.lz4.LZ4SafeDecompressor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.security.InvalidKeyException;</span><br><span class="line"><span class="keyword">import</span> java.security.Key;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.GZIPInputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.Inflater;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.BadPaddingException;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.IllegalBlockSizeException;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.NoSuchPaddingException;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.SecretKeySpec;</span><br><span class="line"><span class="keyword">import</span> net.jpountz.lz4.LZ4Factory;</span><br><span class="line"><span class="keyword">import</span> net.jpountz.lz4.LZ4Compressor;</span><br><span class="line"><span class="keyword">import</span> net.jpountz.lz4.LZ4FastDecompressor;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">Read2</span><span class="params">(String infile)</span> <span class="keyword">throws</span> Exception</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">StringBuffer</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line"></span><br><span class="line">        <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(infile);</span><br><span class="line">        <span class="type">FileInputStream</span> <span class="variable">fis</span> <span class="operator">=</span> <span class="keyword">new</span>  <span class="title class_">FileInputStream</span>(file);</span><br><span class="line">        <span class="type">byte</span> buffer[] = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>((len = fis.read(buffer)) != -<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            sb.append(<span class="keyword">new</span> <span class="title class_">String</span>(buffer, <span class="number">0</span>, len));</span><br><span class="line">            <span class="comment">//sb.append(new String(buffer, 0, len, &quot;UTF-8&quot;));   //将byte转String可以指定编码方式</span></span><br><span class="line">        &#125;</span><br><span class="line">        fis.close();</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Key <span class="title function_">get_key</span><span class="params">(<span class="type">byte</span>[] arg4)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">v0</span> <span class="operator">=</span> <span class="number">8</span>;</span><br><span class="line">        <span class="type">byte</span>[] v1 = <span class="keyword">new</span> <span class="title class_">byte</span>[v0];</span><br><span class="line">        <span class="type">int</span> v2;</span><br><span class="line">        <span class="keyword">for</span>(v2 = <span class="number">0</span>; v2 &lt; arg4.length; ++v2) &#123;</span><br><span class="line">            <span class="keyword">if</span>(v2 &gt;= v0) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            v1[v2] = arg4[v2];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">SecretKeySpec</span>(v1, <span class="string">&quot;DES&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        ByteArrayOutputStream byteArrayOutputStream;</span><br><span class="line">        <span class="type">byte</span>[] byteArray2=<span class="literal">null</span>;</span><br><span class="line">        DataInputStream dataInputStream=<span class="literal">null</span>;</span><br><span class="line">        <span class="type">byte</span>[] bArr=<span class="literal">null</span>;</span><br><span class="line">        <span class="type">byte</span>[] byteArray=<span class="literal">null</span>;</span><br><span class="line">        <span class="type">byte</span>[] bArr3=<span class="literal">null</span>;</span><br><span class="line">        <span class="type">byte</span>[] bArr2=<span class="literal">null</span>;</span><br><span class="line">        <span class="type">byte</span>[] bArr6 = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            dataInputStream = <span class="keyword">new</span> <span class="title class_">DataInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;E:\\EDGE下载\\task_DesignEachStep\\DesignEachStep\\assets\\data\\data&quot;</span>));</span><br><span class="line">            <span class="type">byte</span>[] bArr7 = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">256</span>];</span><br><span class="line">            byteArray2=<span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">400</span>];</span><br><span class="line">            byteArrayOutputStream = <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">read</span> <span class="operator">=</span> dataInputStream.read(bArr7);</span><br><span class="line">                <span class="keyword">if</span> (read &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                byteArrayOutputStream.write(bArr7, <span class="number">0</span>, read);</span><br><span class="line">            &#125;</span><br><span class="line">            byteArray2 = byteArrayOutputStream.toByteArray();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span>(Exception e)</span><br><span class="line">        &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;nonono&quot;</span>);</span><br><span class="line">            System.exit(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">finally</span></span><br><span class="line">        &#123;</span><br><span class="line">            dataInputStream.close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (byteArray2.length &gt;= <span class="number">8</span>) &#123;</span><br><span class="line">            <span class="type">byte</span>[] bArr8 = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">8</span>];</span><br><span class="line">            System.arraycopy(byteArray2, <span class="number">0</span>, bArr8, <span class="number">0</span>, <span class="number">8</span>);</span><br><span class="line">            <span class="type">byte</span>[] bArr9 = <span class="keyword">new</span> <span class="title class_">byte</span>[byteArray2.length - <span class="number">8</span>];</span><br><span class="line">            System.arraycopy(byteArray2, <span class="number">8</span>, bArr9, <span class="number">0</span>, byteArray2.length - <span class="number">8</span>);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">Cipher</span> <span class="variable">cipher</span> <span class="operator">=</span> Cipher.getInstance(<span class="string">&quot;DES&quot;</span>);</span><br><span class="line">                cipher.init(<span class="number">2</span>, get_key(bArr8));</span><br><span class="line">                bArr = cipher.doFinal(bArr9);</span><br><span class="line">                <span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;E:\\EDGE下载\\task_DesignEachStep\\DesignEachStep\\assets\\data\\data2&quot;</span>);</span><br><span class="line">                fos.write(bArr);</span><br><span class="line">                fos.close();</span><br><span class="line">            &#125;<span class="keyword">catch</span>(Exception e)</span><br><span class="line">            &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;cipher error&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">Inflater</span> <span class="variable">inflater</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Inflater</span>();</span><br><span class="line">            inflater.setInput(bArr);</span><br><span class="line">            <span class="type">ByteArrayOutputStream</span> <span class="variable">byteArrayOutputStream2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>(bArr.length);</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="type">byte</span>[] bArr10 = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">                <span class="keyword">while</span> (!inflater.finished()) &#123;</span><br><span class="line">                    byteArrayOutputStream2.write(bArr10, <span class="number">0</span>, inflater.inflate(bArr10));</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span>(Exception e)</span><br><span class="line">            &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;inflater error&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            inflater.end();</span><br><span class="line">            byteArray = byteArrayOutputStream2.toByteArray();</span><br><span class="line">            byteArrayOutputStream2.close();</span><br><span class="line">            <span class="keyword">if</span> (byteArray.length &gt;= <span class="number">8</span>) &#123;</span><br><span class="line">                <span class="type">byte</span>[] bArr11 = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">8</span>];</span><br><span class="line">                System.arraycopy(byteArray, <span class="number">0</span>, bArr11, <span class="number">0</span>, <span class="number">8</span>);</span><br><span class="line">                <span class="type">byte</span>[] bArr12 = <span class="keyword">new</span> <span class="title class_">byte</span>[byteArray.length - <span class="number">8</span>];</span><br><span class="line">                System.arraycopy(byteArray, <span class="number">8</span>, bArr12, <span class="number">0</span>, byteArray.length - <span class="number">8</span>);</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="type">Cipher</span> <span class="variable">cipher2</span> <span class="operator">=</span> Cipher.getInstance(<span class="string">&quot;DES&quot;</span>);</span><br><span class="line">                    cipher2.init(<span class="number">2</span>, get_key(bArr11));</span><br><span class="line">                    bArr3 = cipher2.doFinal(bArr12);</span><br><span class="line">                    <span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;E:\\EDGE下载\\task_DesignEachStep\\DesignEachStep\\assets\\data\\data3&quot;</span>);</span><br><span class="line">                    fos.write(bArr3);</span><br><span class="line">                    fos.close();</span><br><span class="line">                &#125;<span class="keyword">catch</span>(Exception e)</span><br><span class="line">                &#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;cipher2 error &quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            bArr2=bArr3;</span><br><span class="line">            <span class="type">byte</span>[] bArr13 = <span class="keyword">new</span> <span class="title class_">byte</span>[bArr2.length * <span class="number">5</span>];</span><br><span class="line">            <span class="type">LZ4SafeDecompressor</span> <span class="variable">safeDecompressor</span> <span class="operator">=</span> LZ4Factory.safeInstance().safeDecompressor();</span><br><span class="line">            <span class="type">int</span> <span class="variable">decompress</span> <span class="operator">=</span> safeDecompressor.decompress(bArr2, <span class="number">0</span>, bArr2.length, bArr13, <span class="number">0</span>);</span><br><span class="line">            <span class="type">byte</span>[] bArr14 = <span class="keyword">new</span> <span class="title class_">byte</span>[decompress];</span><br><span class="line">            System.arraycopy(bArr13, <span class="number">0</span>, bArr14, <span class="number">0</span>, decompress);</span><br><span class="line">            <span class="type">byte</span>[] bArr15 = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">8</span>];</span><br><span class="line">            System.arraycopy(bArr14, <span class="number">0</span>, bArr15, <span class="number">0</span>, <span class="number">8</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> decompress - <span class="number">8</span>;</span><br><span class="line">            <span class="type">byte</span>[] bArr16 = <span class="keyword">new</span> <span class="title class_">byte</span>[i];</span><br><span class="line">            System.arraycopy(bArr14, <span class="number">8</span>, bArr16, <span class="number">0</span>, i);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">Cipher</span> <span class="variable">cipher3</span> <span class="operator">=</span> Cipher.getInstance(<span class="string">&quot;DES&quot;</span>);</span><br><span class="line">                cipher3.init(<span class="number">2</span>, get_key(bArr15));</span><br><span class="line">                bArr6 = cipher3.doFinal(bArr16);</span><br><span class="line">                <span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;E:\\EDGE下载\\task_DesignEachStep\\DesignEachStep\\assets\\data\\data4.png&quot;</span>);</span><br><span class="line">                fos.write(bArr6);</span><br><span class="line">                fos.close();</span><br><span class="line">            &#125;<span class="keyword">catch</span> (Exception e)</span><br><span class="line">            &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;cipher 3 error&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>虽然中间好像少了8位的密钥，但flag就是最后的png图片data4（doge），那就不管了</p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://cdn.jsdelivr.net/gh/runwu2204/Blog_imgs/202306230010878.png"                      alt="image-20230623001026699"                ></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;只有一个activity组件&lt;/p&gt;
&lt;div class=&quot;highlight-container&quot; data-rel=&quot;Xml&quot;&gt;&lt;figure class=&quot;iseeu highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre</summary>
      
    
    
    
    <category term="CTF WP" scheme="http://example.com/categories/CTF-WP/"/>
    
    <category term="Re" scheme="http://example.com/categories/CTF-WP/Re/"/>
    
    <category term="安卓" scheme="http://example.com/categories/CTF-WP/Re/%E5%AE%89%E5%8D%93/"/>
    
    
  </entry>
  
  <entry>
    <title>柏鹭杯2021baby_python</title>
    <link href="http://example.com/2023/06/21/CTF%20WP/Re/pythonz3/%E6%9F%8F%E9%B9%AD%E6%9D%AF2021baby_python/"/>
    <id>http://example.com/2023/06/21/CTF%20WP/Re/pythonz3/%E6%9F%8F%E9%B9%AD%E6%9D%AF2021baby_python/</id>
    <published>2023-06-21T15:48:28.000Z</published>
    <updated>2023-06-21T15:53:20.000Z</updated>
    
    <content type="html"><![CDATA[<p>标准的pythonexe逆向，</p><p>唯一需要注意的是需要逆向的pyc文件在pyz文件包内</p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://cdn.jsdelivr.net/gh/runwu2204/Blog_imgs/202306212353722.png"                      alt="image-20230621235313652"                ></p><p>下面是源码</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Source Generated with Decompyle++</span></span><br><span class="line"><span class="comment"># File: baby_core.pyc (Python 3.7)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">md5</span>(<span class="params">s = <span class="literal">None</span></span>):</span><br><span class="line">    m = hashlib.md5()</span><br><span class="line">    m.update(s)</span><br><span class="line">    <span class="keyword">return</span> m.hexdigest().lower()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    secret = <span class="built_in">input</span>(<span class="string">&#x27;secret: &#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(secret) != <span class="number">48</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="literal">None</span>.isnumeric():</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    values = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">48</span>, <span class="number">3</span>):</span><br><span class="line">        values.append(<span class="built_in">int</span>(secret[i:i + <span class="number">3</span>]))</span><br><span class="line">    </span><br><span class="line">    co = [</span><br><span class="line">        [</span><br><span class="line">            <span class="number">158</span>,</span><br><span class="line">            <span class="number">195</span>,</span><br><span class="line">            <span class="number">205</span>,</span><br><span class="line">            <span class="number">229</span>,</span><br><span class="line">            <span class="number">213</span>,</span><br><span class="line">            <span class="number">238</span>,</span><br><span class="line">            <span class="number">211</span>,</span><br><span class="line">            <span class="number">198</span>,</span><br><span class="line">            <span class="number">190</span>,</span><br><span class="line">            <span class="number">226</span>,</span><br><span class="line">            <span class="number">135</span>,</span><br><span class="line">            <span class="number">119</span>,</span><br><span class="line">            <span class="number">145</span>,</span><br><span class="line">            <span class="number">205</span>,</span><br><span class="line">            <span class="number">113</span>,</span><br><span class="line">            <span class="number">122</span>],</span><br><span class="line">        [</span><br><span class="line">            <span class="number">234</span>,</span><br><span class="line">            <span class="number">256</span>,</span><br><span class="line">            <span class="number">185</span>,</span><br><span class="line">            <span class="number">253</span>,</span><br><span class="line">            <span class="number">244</span>,</span><br><span class="line">            <span class="number">134</span>,</span><br><span class="line">            <span class="number">102</span>,</span><br><span class="line">            <span class="number">117</span>,</span><br><span class="line">            <span class="number">190</span>,</span><br><span class="line">            <span class="number">106</span>,</span><br><span class="line">            <span class="number">131</span>,</span><br><span class="line">            <span class="number">205</span>,</span><br><span class="line">            <span class="number">198</span>,</span><br><span class="line">            <span class="number">234</span>,</span><br><span class="line">            <span class="number">162</span>,</span><br><span class="line">            <span class="number">218</span>],</span><br><span class="line">        [</span><br><span class="line">            <span class="number">164</span>,</span><br><span class="line">            <span class="number">164</span>,</span><br><span class="line">            <span class="number">209</span>,</span><br><span class="line">            <span class="number">200</span>,</span><br><span class="line">            <span class="number">168</span>,</span><br><span class="line">            <span class="number">226</span>,</span><br><span class="line">            <span class="number">189</span>,</span><br><span class="line">            <span class="number">151</span>,</span><br><span class="line">            <span class="number">253</span>,</span><br><span class="line">            <span class="number">241</span>,</span><br><span class="line">            <span class="number">232</span>,</span><br><span class="line">            <span class="number">151</span>,</span><br><span class="line">            <span class="number">193</span>,</span><br><span class="line">            <span class="number">119</span>,</span><br><span class="line">            <span class="number">226</span>,</span><br><span class="line">            <span class="number">193</span>],</span><br><span class="line">        [</span><br><span class="line">            <span class="number">213</span>,</span><br><span class="line">            <span class="number">117</span>,</span><br><span class="line">            <span class="number">151</span>,</span><br><span class="line">            <span class="number">103</span>,</span><br><span class="line">            <span class="number">249</span>,</span><br><span class="line">            <span class="number">148</span>,</span><br><span class="line">            <span class="number">103</span>,</span><br><span class="line">            <span class="number">213</span>,</span><br><span class="line">            <span class="number">218</span>,</span><br><span class="line">            <span class="number">222</span>,</span><br><span class="line">            <span class="number">104</span>,</span><br><span class="line">            <span class="number">228</span>,</span><br><span class="line">            <span class="number">100</span>,</span><br><span class="line">            <span class="number">206</span>,</span><br><span class="line">            <span class="number">218</span>,</span><br><span class="line">            <span class="number">177</span>],</span><br><span class="line">        [</span><br><span class="line">            <span class="number">217</span>,</span><br><span class="line">            <span class="number">202</span>,</span><br><span class="line">            <span class="number">126</span>,</span><br><span class="line">            <span class="number">214</span>,</span><br><span class="line">            <span class="number">195</span>,</span><br><span class="line">            <span class="number">125</span>,</span><br><span class="line">            <span class="number">144</span>,</span><br><span class="line">            <span class="number">105</span>,</span><br><span class="line">            <span class="number">152</span>,</span><br><span class="line">            <span class="number">118</span>,</span><br><span class="line">            <span class="number">167</span>,</span><br><span class="line">            <span class="number">137</span>,</span><br><span class="line">            <span class="number">171</span>,</span><br><span class="line">            <span class="number">173</span>,</span><br><span class="line">            <span class="number">206</span>,</span><br><span class="line">            <span class="number">240</span>],</span><br><span class="line">        [</span><br><span class="line">            <span class="number">160</span>,</span><br><span class="line">            <span class="number">134</span>,</span><br><span class="line">            <span class="number">131</span>,</span><br><span class="line">            <span class="number">135</span>,</span><br><span class="line">            <span class="number">186</span>,</span><br><span class="line">            <span class="number">213</span>,</span><br><span class="line">            <span class="number">146</span>,</span><br><span class="line">            <span class="number">129</span>,</span><br><span class="line">            <span class="number">125</span>,</span><br><span class="line">            <span class="number">139</span>,</span><br><span class="line">            <span class="number">174</span>,</span><br><span class="line">            <span class="number">205</span>,</span><br><span class="line">            <span class="number">177</span>,</span><br><span class="line">            <span class="number">240</span>,</span><br><span class="line">            <span class="number">194</span>,</span><br><span class="line">            <span class="number">181</span>],</span><br><span class="line">        [</span><br><span class="line">            <span class="number">183</span>,</span><br><span class="line">            <span class="number">213</span>,</span><br><span class="line">            <span class="number">127</span>,</span><br><span class="line">            <span class="number">136</span>,</span><br><span class="line">            <span class="number">136</span>,</span><br><span class="line">            <span class="number">209</span>,</span><br><span class="line">            <span class="number">199</span>,</span><br><span class="line">            <span class="number">191</span>,</span><br><span class="line">            <span class="number">150</span>,</span><br><span class="line">            <span class="number">218</span>,</span><br><span class="line">            <span class="number">160</span>,</span><br><span class="line">            <span class="number">111</span>,</span><br><span class="line">            <span class="number">191</span>,</span><br><span class="line">            <span class="number">226</span>,</span><br><span class="line">            <span class="number">154</span>,</span><br><span class="line">            <span class="number">191</span>],</span><br><span class="line">        [</span><br><span class="line">            <span class="number">247</span>,</span><br><span class="line">            <span class="number">188</span>,</span><br><span class="line">            <span class="number">210</span>,</span><br><span class="line">            <span class="number">219</span>,</span><br><span class="line">            <span class="number">179</span>,</span><br><span class="line">            <span class="number">204</span>,</span><br><span class="line">            <span class="number">155</span>,</span><br><span class="line">            <span class="number">220</span>,</span><br><span class="line">            <span class="number">215</span>,</span><br><span class="line">            <span class="number">127</span>,</span><br><span class="line">            <span class="number">225</span>,</span><br><span class="line">            <span class="number">214</span>,</span><br><span class="line">            <span class="number">195</span>,</span><br><span class="line">            <span class="number">162</span>,</span><br><span class="line">            <span class="number">214</span>,</span><br><span class="line">            <span class="number">239</span>],</span><br><span class="line">        [</span><br><span class="line">            <span class="number">108</span>,</span><br><span class="line">            <span class="number">112</span>,</span><br><span class="line">            <span class="number">104</span>,</span><br><span class="line">            <span class="number">133</span>,</span><br><span class="line">            <span class="number">178</span>,</span><br><span class="line">            <span class="number">138</span>,</span><br><span class="line">            <span class="number">110</span>,</span><br><span class="line">            <span class="number">176</span>,</span><br><span class="line">            <span class="number">232</span>,</span><br><span class="line">            <span class="number">124</span>,</span><br><span class="line">            <span class="number">193</span>,</span><br><span class="line">            <span class="number">239</span>,</span><br><span class="line">            <span class="number">131</span>,</span><br><span class="line">            <span class="number">138</span>,</span><br><span class="line">            <span class="number">161</span>,</span><br><span class="line">            <span class="number">218</span>],</span><br><span class="line">        [</span><br><span class="line">            <span class="number">140</span>,</span><br><span class="line">            <span class="number">213</span>,</span><br><span class="line">            <span class="number">142</span>,</span><br><span class="line">            <span class="number">181</span>,</span><br><span class="line">            <span class="number">179</span>,</span><br><span class="line">            <span class="number">173</span>,</span><br><span class="line">            <span class="number">203</span>,</span><br><span class="line">            <span class="number">208</span>,</span><br><span class="line">            <span class="number">184</span>,</span><br><span class="line">            <span class="number">129</span>,</span><br><span class="line">            <span class="number">129</span>,</span><br><span class="line">            <span class="number">119</span>,</span><br><span class="line">            <span class="number">122</span>,</span><br><span class="line">            <span class="number">152</span>,</span><br><span class="line">            <span class="number">186</span>,</span><br><span class="line">            <span class="number">124</span>],</span><br><span class="line">        [</span><br><span class="line">            <span class="number">105</span>,</span><br><span class="line">            <span class="number">205</span>,</span><br><span class="line">            <span class="number">124</span>,</span><br><span class="line">            <span class="number">142</span>,</span><br><span class="line">            <span class="number">175</span>,</span><br><span class="line">            <span class="number">184</span>,</span><br><span class="line">            <span class="number">234</span>,</span><br><span class="line">            <span class="number">119</span>,</span><br><span class="line">            <span class="number">195</span>,</span><br><span class="line">            <span class="number">218</span>,</span><br><span class="line">            <span class="number">141</span>,</span><br><span class="line">            <span class="number">122</span>,</span><br><span class="line">            <span class="number">202</span>,</span><br><span class="line">            <span class="number">202</span>,</span><br><span class="line">            <span class="number">190</span>,</span><br><span class="line">            <span class="number">178</span>],</span><br><span class="line">        [</span><br><span class="line">            <span class="number">183</span>,</span><br><span class="line">            <span class="number">178</span>,</span><br><span class="line">            <span class="number">256</span>,</span><br><span class="line">            <span class="number">124</span>,</span><br><span class="line">            <span class="number">241</span>,</span><br><span class="line">            <span class="number">132</span>,</span><br><span class="line">            <span class="number">163</span>,</span><br><span class="line">            <span class="number">209</span>,</span><br><span class="line">            <span class="number">204</span>,</span><br><span class="line">            <span class="number">104</span>,</span><br><span class="line">            <span class="number">175</span>,</span><br><span class="line">            <span class="number">211</span>,</span><br><span class="line">            <span class="number">196</span>,</span><br><span class="line">            <span class="number">136</span>,</span><br><span class="line">            <span class="number">158</span>,</span><br><span class="line">            <span class="number">210</span>],</span><br><span class="line">        [</span><br><span class="line">            <span class="number">224</span>,</span><br><span class="line">            <span class="number">144</span>,</span><br><span class="line">            <span class="number">189</span>,</span><br><span class="line">            <span class="number">106</span>,</span><br><span class="line">            <span class="number">177</span>,</span><br><span class="line">            <span class="number">251</span>,</span><br><span class="line">            <span class="number">206</span>,</span><br><span class="line">            <span class="number">163</span>,</span><br><span class="line">            <span class="number">167</span>,</span><br><span class="line">            <span class="number">144</span>,</span><br><span class="line">            <span class="number">208</span>,</span><br><span class="line">            <span class="number">254</span>,</span><br><span class="line">            <span class="number">117</span>,</span><br><span class="line">            <span class="number">253</span>,</span><br><span class="line">            <span class="number">100</span>,</span><br><span class="line">            <span class="number">106</span>],</span><br><span class="line">        [</span><br><span class="line">            <span class="number">251</span>,</span><br><span class="line">            <span class="number">251</span>,</span><br><span class="line">            <span class="number">136</span>,</span><br><span class="line">            <span class="number">170</span>,</span><br><span class="line">            <span class="number">145</span>,</span><br><span class="line">            <span class="number">177</span>,</span><br><span class="line">            <span class="number">175</span>,</span><br><span class="line">            <span class="number">124</span>,</span><br><span class="line">            <span class="number">193</span>,</span><br><span class="line">            <span class="number">188</span>,</span><br><span class="line">            <span class="number">193</span>,</span><br><span class="line">            <span class="number">198</span>,</span><br><span class="line">            <span class="number">208</span>,</span><br><span class="line">            <span class="number">171</span>,</span><br><span class="line">            <span class="number">151</span>,</span><br><span class="line">            <span class="number">230</span>],</span><br><span class="line">        [</span><br><span class="line">            <span class="number">143</span>,</span><br><span class="line">            <span class="number">200</span>,</span><br><span class="line">            <span class="number">143</span>,</span><br><span class="line">            <span class="number">150</span>,</span><br><span class="line">            <span class="number">243</span>,</span><br><span class="line">            <span class="number">148</span>,</span><br><span class="line">            <span class="number">136</span>,</span><br><span class="line">            <span class="number">213</span>,</span><br><span class="line">            <span class="number">161</span>,</span><br><span class="line">            <span class="number">224</span>,</span><br><span class="line">            <span class="number">170</span>,</span><br><span class="line">            <span class="number">208</span>,</span><br><span class="line">            <span class="number">185</span>,</span><br><span class="line">            <span class="number">117</span>,</span><br><span class="line">            <span class="number">189</span>,</span><br><span class="line">            <span class="number">242</span>],</span><br><span class="line">        [</span><br><span class="line">            <span class="number">234</span>,</span><br><span class="line">            <span class="number">188</span>,</span><br><span class="line">            <span class="number">226</span>,</span><br><span class="line">            <span class="number">194</span>,</span><br><span class="line">            <span class="number">248</span>,</span><br><span class="line">            <span class="number">168</span>,</span><br><span class="line">            <span class="number">250</span>,</span><br><span class="line">            <span class="number">244</span>,</span><br><span class="line">            <span class="number">166</span>,</span><br><span class="line">            <span class="number">106</span>,</span><br><span class="line">            <span class="number">113</span>,</span><br><span class="line">            <span class="number">218</span>,</span><br><span class="line">            <span class="number">209</span>,</span><br><span class="line">            <span class="number">220</span>,</span><br><span class="line">            <span class="number">158</span>,</span><br><span class="line">            <span class="number">228</span>]]</span><br><span class="line">    r = [</span><br><span class="line">        <span class="number">472214</span>,</span><br><span class="line">        <span class="number">480121</span>,</span><br><span class="line">        <span class="number">506256</span>,</span><br><span class="line">        <span class="number">449505</span>,</span><br><span class="line">        <span class="number">433390</span>,</span><br><span class="line">        <span class="number">435414</span>,</span><br><span class="line">        <span class="number">453899</span>,</span><br><span class="line">        <span class="number">536361</span>,</span><br><span class="line">        <span class="number">423332</span>,</span><br><span class="line">        <span class="number">427624</span>,</span><br><span class="line">        <span class="number">440268</span>,</span><br><span class="line">        <span class="number">488759</span>,</span><br><span class="line">        <span class="number">469049</span>,</span><br><span class="line">        <span class="number">484574</span>,</span><br><span class="line">        <span class="number">480266</span>,</span><br><span class="line">        <span class="number">522818</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        v = <span class="number">0</span></span><br><span class="line">        str1=<span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">            v += co[i][j] * values[j]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> v != r[i]:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;flag&#123;ISEC-%s&#125;&#x27;</span> % md5(secret.encode()))</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span>*</span><br><span class="line">flag=[Int(<span class="string">f&#x27;flag[<span class="subst">&#123;i&#125;</span>]&#x27;</span>)<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)]</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><p>z3脚本</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Source Generated with Decompyle++</span></span><br><span class="line"><span class="comment"># File: baby_core.pyc (Python 3.7)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">md5</span>(<span class="params">s = <span class="literal">None</span></span>):</span><br><span class="line">    m = hashlib.md5()</span><br><span class="line">    m.update(s)</span><br><span class="line">    <span class="keyword">return</span> m.hexdigest().lower()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">co = [</span><br><span class="line">    [</span><br><span class="line">        <span class="number">158</span>,</span><br><span class="line">        <span class="number">195</span>,</span><br><span class="line">        <span class="number">205</span>,</span><br><span class="line">        <span class="number">229</span>,</span><br><span class="line">        <span class="number">213</span>,</span><br><span class="line">        <span class="number">238</span>,</span><br><span class="line">        <span class="number">211</span>,</span><br><span class="line">        <span class="number">198</span>,</span><br><span class="line">        <span class="number">190</span>,</span><br><span class="line">        <span class="number">226</span>,</span><br><span class="line">        <span class="number">135</span>,</span><br><span class="line">        <span class="number">119</span>,</span><br><span class="line">        <span class="number">145</span>,</span><br><span class="line">        <span class="number">205</span>,</span><br><span class="line">        <span class="number">113</span>,</span><br><span class="line">        <span class="number">122</span>],</span><br><span class="line">    [</span><br><span class="line">        <span class="number">234</span>,</span><br><span class="line">        <span class="number">256</span>,</span><br><span class="line">        <span class="number">185</span>,</span><br><span class="line">        <span class="number">253</span>,</span><br><span class="line">        <span class="number">244</span>,</span><br><span class="line">        <span class="number">134</span>,</span><br><span class="line">        <span class="number">102</span>,</span><br><span class="line">        <span class="number">117</span>,</span><br><span class="line">        <span class="number">190</span>,</span><br><span class="line">        <span class="number">106</span>,</span><br><span class="line">        <span class="number">131</span>,</span><br><span class="line">        <span class="number">205</span>,</span><br><span class="line">        <span class="number">198</span>,</span><br><span class="line">        <span class="number">234</span>,</span><br><span class="line">        <span class="number">162</span>,</span><br><span class="line">        <span class="number">218</span>],</span><br><span class="line">    [</span><br><span class="line">        <span class="number">164</span>,</span><br><span class="line">        <span class="number">164</span>,</span><br><span class="line">        <span class="number">209</span>,</span><br><span class="line">        <span class="number">200</span>,</span><br><span class="line">        <span class="number">168</span>,</span><br><span class="line">        <span class="number">226</span>,</span><br><span class="line">        <span class="number">189</span>,</span><br><span class="line">        <span class="number">151</span>,</span><br><span class="line">        <span class="number">253</span>,</span><br><span class="line">        <span class="number">241</span>,</span><br><span class="line">        <span class="number">232</span>,</span><br><span class="line">        <span class="number">151</span>,</span><br><span class="line">        <span class="number">193</span>,</span><br><span class="line">        <span class="number">119</span>,</span><br><span class="line">        <span class="number">226</span>,</span><br><span class="line">        <span class="number">193</span>],</span><br><span class="line">    [</span><br><span class="line">        <span class="number">213</span>,</span><br><span class="line">        <span class="number">117</span>,</span><br><span class="line">        <span class="number">151</span>,</span><br><span class="line">        <span class="number">103</span>,</span><br><span class="line">        <span class="number">249</span>,</span><br><span class="line">        <span class="number">148</span>,</span><br><span class="line">        <span class="number">103</span>,</span><br><span class="line">        <span class="number">213</span>,</span><br><span class="line">        <span class="number">218</span>,</span><br><span class="line">        <span class="number">222</span>,</span><br><span class="line">        <span class="number">104</span>,</span><br><span class="line">        <span class="number">228</span>,</span><br><span class="line">        <span class="number">100</span>,</span><br><span class="line">        <span class="number">206</span>,</span><br><span class="line">        <span class="number">218</span>,</span><br><span class="line">        <span class="number">177</span>],</span><br><span class="line">    [</span><br><span class="line">        <span class="number">217</span>,</span><br><span class="line">        <span class="number">202</span>,</span><br><span class="line">        <span class="number">126</span>,</span><br><span class="line">        <span class="number">214</span>,</span><br><span class="line">        <span class="number">195</span>,</span><br><span class="line">        <span class="number">125</span>,</span><br><span class="line">        <span class="number">144</span>,</span><br><span class="line">        <span class="number">105</span>,</span><br><span class="line">        <span class="number">152</span>,</span><br><span class="line">        <span class="number">118</span>,</span><br><span class="line">        <span class="number">167</span>,</span><br><span class="line">        <span class="number">137</span>,</span><br><span class="line">        <span class="number">171</span>,</span><br><span class="line">        <span class="number">173</span>,</span><br><span class="line">        <span class="number">206</span>,</span><br><span class="line">        <span class="number">240</span>],</span><br><span class="line">    [</span><br><span class="line">        <span class="number">160</span>,</span><br><span class="line">        <span class="number">134</span>,</span><br><span class="line">        <span class="number">131</span>,</span><br><span class="line">        <span class="number">135</span>,</span><br><span class="line">        <span class="number">186</span>,</span><br><span class="line">        <span class="number">213</span>,</span><br><span class="line">        <span class="number">146</span>,</span><br><span class="line">        <span class="number">129</span>,</span><br><span class="line">        <span class="number">125</span>,</span><br><span class="line">        <span class="number">139</span>,</span><br><span class="line">        <span class="number">174</span>,</span><br><span class="line">        <span class="number">205</span>,</span><br><span class="line">        <span class="number">177</span>,</span><br><span class="line">        <span class="number">240</span>,</span><br><span class="line">        <span class="number">194</span>,</span><br><span class="line">        <span class="number">181</span>],</span><br><span class="line">    [</span><br><span class="line">        <span class="number">183</span>,</span><br><span class="line">        <span class="number">213</span>,</span><br><span class="line">        <span class="number">127</span>,</span><br><span class="line">        <span class="number">136</span>,</span><br><span class="line">        <span class="number">136</span>,</span><br><span class="line">        <span class="number">209</span>,</span><br><span class="line">        <span class="number">199</span>,</span><br><span class="line">        <span class="number">191</span>,</span><br><span class="line">        <span class="number">150</span>,</span><br><span class="line">        <span class="number">218</span>,</span><br><span class="line">        <span class="number">160</span>,</span><br><span class="line">        <span class="number">111</span>,</span><br><span class="line">        <span class="number">191</span>,</span><br><span class="line">        <span class="number">226</span>,</span><br><span class="line">        <span class="number">154</span>,</span><br><span class="line">        <span class="number">191</span>],</span><br><span class="line">    [</span><br><span class="line">        <span class="number">247</span>,</span><br><span class="line">        <span class="number">188</span>,</span><br><span class="line">        <span class="number">210</span>,</span><br><span class="line">        <span class="number">219</span>,</span><br><span class="line">        <span class="number">179</span>,</span><br><span class="line">        <span class="number">204</span>,</span><br><span class="line">        <span class="number">155</span>,</span><br><span class="line">        <span class="number">220</span>,</span><br><span class="line">        <span class="number">215</span>,</span><br><span class="line">        <span class="number">127</span>,</span><br><span class="line">        <span class="number">225</span>,</span><br><span class="line">        <span class="number">214</span>,</span><br><span class="line">        <span class="number">195</span>,</span><br><span class="line">        <span class="number">162</span>,</span><br><span class="line">        <span class="number">214</span>,</span><br><span class="line">        <span class="number">239</span>],</span><br><span class="line">    [</span><br><span class="line">        <span class="number">108</span>,</span><br><span class="line">        <span class="number">112</span>,</span><br><span class="line">        <span class="number">104</span>,</span><br><span class="line">        <span class="number">133</span>,</span><br><span class="line">        <span class="number">178</span>,</span><br><span class="line">        <span class="number">138</span>,</span><br><span class="line">        <span class="number">110</span>,</span><br><span class="line">        <span class="number">176</span>,</span><br><span class="line">        <span class="number">232</span>,</span><br><span class="line">        <span class="number">124</span>,</span><br><span class="line">        <span class="number">193</span>,</span><br><span class="line">        <span class="number">239</span>,</span><br><span class="line">        <span class="number">131</span>,</span><br><span class="line">        <span class="number">138</span>,</span><br><span class="line">        <span class="number">161</span>,</span><br><span class="line">        <span class="number">218</span>],</span><br><span class="line">    [</span><br><span class="line">        <span class="number">140</span>,</span><br><span class="line">        <span class="number">213</span>,</span><br><span class="line">        <span class="number">142</span>,</span><br><span class="line">        <span class="number">181</span>,</span><br><span class="line">        <span class="number">179</span>,</span><br><span class="line">        <span class="number">173</span>,</span><br><span class="line">        <span class="number">203</span>,</span><br><span class="line">        <span class="number">208</span>,</span><br><span class="line">        <span class="number">184</span>,</span><br><span class="line">        <span class="number">129</span>,</span><br><span class="line">        <span class="number">129</span>,</span><br><span class="line">        <span class="number">119</span>,</span><br><span class="line">        <span class="number">122</span>,</span><br><span class="line">        <span class="number">152</span>,</span><br><span class="line">        <span class="number">186</span>,</span><br><span class="line">        <span class="number">124</span>],</span><br><span class="line">    [</span><br><span class="line">        <span class="number">105</span>,</span><br><span class="line">        <span class="number">205</span>,</span><br><span class="line">        <span class="number">124</span>,</span><br><span class="line">        <span class="number">142</span>,</span><br><span class="line">        <span class="number">175</span>,</span><br><span class="line">        <span class="number">184</span>,</span><br><span class="line">        <span class="number">234</span>,</span><br><span class="line">        <span class="number">119</span>,</span><br><span class="line">        <span class="number">195</span>,</span><br><span class="line">        <span class="number">218</span>,</span><br><span class="line">        <span class="number">141</span>,</span><br><span class="line">        <span class="number">122</span>,</span><br><span class="line">        <span class="number">202</span>,</span><br><span class="line">        <span class="number">202</span>,</span><br><span class="line">        <span class="number">190</span>,</span><br><span class="line">        <span class="number">178</span>],</span><br><span class="line">    [</span><br><span class="line">        <span class="number">183</span>,</span><br><span class="line">        <span class="number">178</span>,</span><br><span class="line">        <span class="number">256</span>,</span><br><span class="line">        <span class="number">124</span>,</span><br><span class="line">        <span class="number">241</span>,</span><br><span class="line">        <span class="number">132</span>,</span><br><span class="line">        <span class="number">163</span>,</span><br><span class="line">        <span class="number">209</span>,</span><br><span class="line">        <span class="number">204</span>,</span><br><span class="line">        <span class="number">104</span>,</span><br><span class="line">        <span class="number">175</span>,</span><br><span class="line">        <span class="number">211</span>,</span><br><span class="line">        <span class="number">196</span>,</span><br><span class="line">        <span class="number">136</span>,</span><br><span class="line">        <span class="number">158</span>,</span><br><span class="line">        <span class="number">210</span>],</span><br><span class="line">    [</span><br><span class="line">        <span class="number">224</span>,</span><br><span class="line">        <span class="number">144</span>,</span><br><span class="line">        <span class="number">189</span>,</span><br><span class="line">        <span class="number">106</span>,</span><br><span class="line">        <span class="number">177</span>,</span><br><span class="line">        <span class="number">251</span>,</span><br><span class="line">        <span class="number">206</span>,</span><br><span class="line">        <span class="number">163</span>,</span><br><span class="line">        <span class="number">167</span>,</span><br><span class="line">        <span class="number">144</span>,</span><br><span class="line">        <span class="number">208</span>,</span><br><span class="line">        <span class="number">254</span>,</span><br><span class="line">        <span class="number">117</span>,</span><br><span class="line">        <span class="number">253</span>,</span><br><span class="line">        <span class="number">100</span>,</span><br><span class="line">        <span class="number">106</span>],</span><br><span class="line">    [</span><br><span class="line">        <span class="number">251</span>,</span><br><span class="line">        <span class="number">251</span>,</span><br><span class="line">        <span class="number">136</span>,</span><br><span class="line">        <span class="number">170</span>,</span><br><span class="line">        <span class="number">145</span>,</span><br><span class="line">        <span class="number">177</span>,</span><br><span class="line">        <span class="number">175</span>,</span><br><span class="line">        <span class="number">124</span>,</span><br><span class="line">        <span class="number">193</span>,</span><br><span class="line">        <span class="number">188</span>,</span><br><span class="line">        <span class="number">193</span>,</span><br><span class="line">        <span class="number">198</span>,</span><br><span class="line">        <span class="number">208</span>,</span><br><span class="line">        <span class="number">171</span>,</span><br><span class="line">        <span class="number">151</span>,</span><br><span class="line">        <span class="number">230</span>],</span><br><span class="line">    [</span><br><span class="line">        <span class="number">143</span>,</span><br><span class="line">        <span class="number">200</span>,</span><br><span class="line">        <span class="number">143</span>,</span><br><span class="line">        <span class="number">150</span>,</span><br><span class="line">        <span class="number">243</span>,</span><br><span class="line">        <span class="number">148</span>,</span><br><span class="line">        <span class="number">136</span>,</span><br><span class="line">        <span class="number">213</span>,</span><br><span class="line">        <span class="number">161</span>,</span><br><span class="line">        <span class="number">224</span>,</span><br><span class="line">        <span class="number">170</span>,</span><br><span class="line">        <span class="number">208</span>,</span><br><span class="line">        <span class="number">185</span>,</span><br><span class="line">        <span class="number">117</span>,</span><br><span class="line">        <span class="number">189</span>,</span><br><span class="line">        <span class="number">242</span>],</span><br><span class="line">    [</span><br><span class="line">        <span class="number">234</span>,</span><br><span class="line">        <span class="number">188</span>,</span><br><span class="line">        <span class="number">226</span>,</span><br><span class="line">        <span class="number">194</span>,</span><br><span class="line">        <span class="number">248</span>,</span><br><span class="line">        <span class="number">168</span>,</span><br><span class="line">        <span class="number">250</span>,</span><br><span class="line">        <span class="number">244</span>,</span><br><span class="line">        <span class="number">166</span>,</span><br><span class="line">        <span class="number">106</span>,</span><br><span class="line">        <span class="number">113</span>,</span><br><span class="line">        <span class="number">218</span>,</span><br><span class="line">        <span class="number">209</span>,</span><br><span class="line">        <span class="number">220</span>,</span><br><span class="line">        <span class="number">158</span>,</span><br><span class="line">        <span class="number">228</span>]]</span><br><span class="line">r = [</span><br><span class="line">    <span class="number">472214</span>,</span><br><span class="line">    <span class="number">480121</span>,</span><br><span class="line">    <span class="number">506256</span>,</span><br><span class="line">    <span class="number">449505</span>,</span><br><span class="line">    <span class="number">433390</span>,</span><br><span class="line">    <span class="number">435414</span>,</span><br><span class="line">    <span class="number">453899</span>,</span><br><span class="line">    <span class="number">536361</span>,</span><br><span class="line">    <span class="number">423332</span>,</span><br><span class="line">    <span class="number">427624</span>,</span><br><span class="line">    <span class="number">440268</span>,</span><br><span class="line">    <span class="number">488759</span>,</span><br><span class="line">    <span class="number">469049</span>,</span><br><span class="line">    <span class="number">484574</span>,</span><br><span class="line">    <span class="number">480266</span>,</span><br><span class="line">    <span class="number">522818</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span>*</span><br><span class="line">f=Solver()</span><br><span class="line">flag=[Int(<span class="string">f&#x27;flag[<span class="subst">&#123;i&#125;</span>]&#x27;</span>)<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">v = <span class="number">0</span></span><br><span class="line">str1=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">v += co[i][j] * flag[j]</span><br><span class="line"></span><br><span class="line">f.add(v==r[i])</span><br><span class="line">str1=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line"><span class="keyword">if</span>(f.check()==sat):</span><br><span class="line">m=f.model()</span><br><span class="line">str1+=<span class="built_in">str</span>(m[flag[i]])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;NSSCTF&#123;ISEC-&quot;</span>+md5(str1.encode())+<span class="string">&quot;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure></div>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;标准的pythonexe逆向，&lt;/p&gt;
&lt;p&gt;唯一需要注意的是需要逆向的pyc文件在pyz文件包内&lt;/p&gt;
&lt;p&gt;&lt;img  
                     lazyload
                     src=&quot;/images/loading.s</summary>
      
    
    
    
    <category term="CTF WP" scheme="http://example.com/categories/CTF-WP/"/>
    
    <category term="Re" scheme="http://example.com/categories/CTF-WP/Re/"/>
    
    <category term="pythonz3" scheme="http://example.com/categories/CTF-WP/Re/pythonz3/"/>
    
    
  </entry>
  
  <entry>
    <title>事件绑定</title>
    <link href="http://example.com/2023/06/21/%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91/%E4%BA%8B%E4%BB%B6%E7%BB%91%E5%AE%9A/"/>
    <id>http://example.com/2023/06/21/%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91/%E4%BA%8B%E4%BB%B6%E7%BB%91%E5%AE%9A/</id>
    <published>2023-06-21T14:39:14.000Z</published>
    <updated>2023-06-21T15:01:23.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Click事件"><a href="#Click事件" class="headerlink" title="Click事件"></a>Click事件</h1><h2 id="获取对应事件按钮的id"><a href="#获取对应事件按钮的id" class="headerlink" title="获取对应事件按钮的id"></a>获取对应事件按钮的id</h2><div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> ImageButton imgbutton;</span><br><span class="line">imgbutton=findViewById(R.id.x)<span class="comment">// 此处x为对应的id名</span></span><br></pre></td></tr></table></figure></div><h2 id="建立对应事件的监听器"><a href="#建立对应事件的监听器" class="headerlink" title="建立对应事件的监听器"></a>建立对应事件的监听器</h2><p>有两种方法</p><h3 id="新建一个类传入一个对Onclick方法的重载"><a href="#新建一个类传入一个对Onclick方法的重载" class="headerlink" title="新建一个类传入一个对Onclick方法的重载"></a>新建一个类传入一个对Onclick方法的重载</h3><div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">imgbutton.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line">                <span class="comment">//函数体</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br></pre></td></tr></table></figure></div><h3 id="直接使用java-lambda函数"><a href="#直接使用java-lambda函数" class="headerlink" title="直接使用java lambda函数"></a>直接使用java lambda函数</h3><div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">imgbutton.setOnClickListener( v-&gt;&#123;</span><br><span class="line">    <span class="comment">//函数体</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div><p>此处v为参数，java可以自动确定其参数类型，也可以自己指定</p><div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">imgbutton.setOnClickListener((View v)-&gt;&#123;</span><br><span class="line">    <span class="comment">//函数体</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Click事件&quot;&gt;&lt;a href=&quot;#Click事件&quot; class=&quot;headerlink&quot; title=&quot;Click事件&quot;&gt;&lt;/a&gt;Click事件&lt;/h1&gt;&lt;h2 id=&quot;获取对应事件按钮的id&quot;&gt;&lt;a href=&quot;#获取对应事件按钮的id&quot; class=&quot;he</summary>
      
    
    
    
    <category term="安卓开发" scheme="http://example.com/categories/%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91/"/>
    
    
  </entry>
  
  <entry>
    <title>组件相关</title>
    <link href="http://example.com/2023/06/21/%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91/%E7%BB%84%E4%BB%B6%E7%9B%B8%E5%85%B3/"/>
    <id>http://example.com/2023/06/21/%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91/%E7%BB%84%E4%BB%B6%E7%9B%B8%E5%85%B3/</id>
    <published>2023-06-21T13:50:38.000Z</published>
    <updated>2023-06-21T14:45:29.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="约束模式"><a href="#约束模式" class="headerlink" title="约束模式"></a>约束模式</h1><p>约束模式相对于其他模式更加简单，可以直接拖动组件来改变布局。</p><p>参考<a class="link"   href="https://developer.android.google.cn/training/constraint-layout?hl=zh-cn" >使用 ConstraintLayout 构建自适应界面  | Android 开发者  | Android Developers (google.cn) <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p><p>基本如下</p><div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p>其所有元素都是约束在这个框架内的，需要设定相应的长宽</p><p>先点击此按钮进行消除对应的约束，不然不能正常移动组件的位置</p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://cdn.jsdelivr.net/gh/runwu2204/Blog_imgs/202306212245063.png"                      alt="image-20230621224501024"                ></p><p>调整好位置后再点击自动设置约束</p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://cdn.jsdelivr.net/gh/runwu2204/Blog_imgs/202306212243554.png"                      alt="image-20230621224331514"                ></p><p>基本就是这样就可以调整各个视图组件的位置。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;约束模式&quot;&gt;&lt;a href=&quot;#约束模式&quot; class=&quot;headerlink&quot; title=&quot;约束模式&quot;&gt;&lt;/a&gt;约束模式&lt;/h1&gt;&lt;p&gt;约束模式相对于其他模式更加简单，可以直接拖动组件来改变布局。&lt;/p&gt;
&lt;p&gt;参考&lt;a class=&quot;link&quot;   href</summary>
      
    
    
    
    <category term="安卓开发" scheme="http://example.com/categories/%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91/"/>
    
    
  </entry>
  
  <entry>
    <title>CISCN 2021初赛glass</title>
    <link href="http://example.com/2023/06/17/CTF%20WP/Re/%E5%AE%89%E5%8D%93/CISCN%202021%E5%88%9D%E8%B5%9Bglass/"/>
    <id>http://example.com/2023/06/17/CTF%20WP/Re/%E5%AE%89%E5%8D%93/CISCN%202021%E5%88%9D%E8%B5%9Bglass/</id>
    <published>2023-06-16T16:48:51.000Z</published>
    <updated>2023-06-16T16:57:44.000Z</updated>
    
    <content type="html"><![CDATA[<p>查看组件，就一个activity，直接看</p><div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> <span class="attr">android:versionCode</span>=<span class="string">&quot;1&quot;</span> <span class="attr">android:versionName</span>=<span class="string">&quot;1.0&quot;</span> <span class="attr">android:compileSdkVersion</span>=<span class="string">&quot;30&quot;</span> <span class="attr">android:compileSdkVersionCodename</span>=<span class="string">&quot;11&quot;</span> <span class="attr">package</span>=<span class="string">&quot;com.ciscn.glass&quot;</span> <span class="attr">platformBuildVersionCode</span>=<span class="string">&quot;30&quot;</span> <span class="attr">platformBuildVersionName</span>=<span class="string">&quot;11&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-sdk</span> <span class="attr">android:minSdkVersion</span>=<span class="string">&quot;15&quot;</span> <span class="attr">android:targetSdkVersion</span>=<span class="string">&quot;30&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">application</span> <span class="attr">android:theme</span>=<span class="string">&quot;@style/AppTheme&quot;</span> <span class="attr">android:label</span>=<span class="string">&quot;@string/app_name&quot;</span> <span class="attr">android:icon</span>=<span class="string">&quot;@mipmap/ic_launcher&quot;</span> <span class="attr">android:allowBackup</span>=<span class="string">&quot;true&quot;</span> <span class="attr">android:supportsRtl</span>=<span class="string">&quot;true&quot;</span> <span class="attr">android:roundIcon</span>=<span class="string">&quot;@mipmap/ic_launcher_round&quot;</span> <span class="attr">android:appComponentFactory</span>=<span class="string">&quot;androidx.core.app.CoreComponentFactory&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">&quot;com.ciscn.glass.MainActivity&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.action.MAIN&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.category.LAUNCHER&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p>是一个标准的调用JNI接口的校验</p><div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ciscn.glass;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.EditText;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: classes.dex */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    Button but;</span><br><span class="line">    EditText txt;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">native</span> <span class="type">boolean</span> <span class="title function_">checkFlag</span><span class="params">(String str)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.loadLibrary(<span class="string">&quot;native-lib&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX INFO: Access modifiers changed from: protected */</span></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// androidx.appcompat.app.AppCompatActivity, androidx.fragment.app.FragmentActivity, androidx.core.app.ComponentActivity, android.app.Activity</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle bundle)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(bundle);</span><br><span class="line">        setContentView(C0273R.layout.activity_main);</span><br><span class="line">        <span class="built_in">this</span>.but = (Button) findViewById(C0273R.C0275id.button);</span><br><span class="line">        <span class="built_in">this</span>.txt = (EditText) findViewById(C0273R.C0275id.editText);</span><br><span class="line">        <span class="built_in">this</span>.but.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123; <span class="comment">// from class: com.ciscn.glass.MainActivity.1</span></span><br><span class="line">            <span class="meta">@Override</span> <span class="comment">// android.view.View.OnClickListener</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">                <span class="type">MainActivity</span> <span class="variable">mainActivity</span> <span class="operator">=</span> MainActivity.<span class="built_in">this</span>;</span><br><span class="line">                <span class="keyword">if</span> (mainActivity.checkFlag(mainActivity.txt.getText().toString())) <span class="comment">//校验flag</span></span><br><span class="line">                &#123;</span><br><span class="line">                    Toast.makeText(MainActivity.<span class="built_in">this</span>, <span class="string">&quot;right!&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    Toast.makeText(MainActivity.<span class="built_in">this</span>, <span class="string">&quot;wrong!&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>JNI中的checkFlag函数</p><div class="highlight-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">bool</span> __fastcall <span class="title function_">Java_com_ciscn_glass_MainActivity_checkFlag</span><span class="params">(<span class="type">int</span> a1, <span class="type">int</span> a2, <span class="type">int</span> a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *v3; <span class="comment">// r4</span></span><br><span class="line">  <span class="type">int</span> length; <span class="comment">// r5</span></span><br><span class="line">  <span class="type">char</span> key[<span class="number">256</span>]; <span class="comment">// [sp+0h] [bp-220h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v7[<span class="number">260</span>]; <span class="comment">// [sp+100h] [bp-120h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v3 = (<span class="type">const</span> <span class="type">char</span> *)sub_F0C(a1, a3);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(v3) != <span class="number">39</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(v7, <span class="number">0</span>, <span class="number">0x100</span>u);</span><br><span class="line">  qmemcpy(key, <span class="string">&quot;12345678&quot;</span>, <span class="keyword">sizeof</span>(key));</span><br><span class="line">  length = <span class="built_in">strlen</span>(key);                         <span class="comment">// 8</span></span><br><span class="line">  sub_FFC(v7, (<span class="type">int</span>)key, length);</span><br><span class="line">  sub_1088(v7, v3, <span class="number">39</span>);</span><br><span class="line">  sub_10D4(v3, <span class="number">39</span>, key, length);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">memcmp</span>(v3, &amp;unk_497C, <span class="number">0x27</span>u) == <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/****************************下面是rc4加密的函数，key是上方的“12345678”********************************************/</span></span><br><span class="line"><span class="type">int</span> __fastcall <span class="title function_">sub_FFC</span><span class="params">(<span class="type">char</span> *a1, <span class="type">char</span> *a2, <span class="type">int</span> a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// r6</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// r1</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// r0</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// r1</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// r3</span></span><br><span class="line">  _BYTE v12[<span class="number">260</span>]; <span class="comment">// [sp+0h] [bp-120h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(v12, <span class="number">0</span>, <span class="number">0x100</span>u);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i != <span class="number">256</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    a1[i] = i;</span><br><span class="line">    sub_126C(i, a3);</span><br><span class="line">    v12[i] = a2[v7];</span><br><span class="line">  &#125;</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( v8 != <span class="number">256</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = (<span class="type">unsigned</span> __int8)a1[v8];</span><br><span class="line">    v9 = (v9 + v10 + (<span class="type">unsigned</span> __int8)v12[v8]) % <span class="number">256</span>;</span><br><span class="line">    a1[v8++] = a1[v9];</span><br><span class="line">    a1[v9] = v10;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> _stack_chk_guard;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> *__fastcall <span class="title function_">sub_1088</span><span class="params">(<span class="type">char</span> *result, <span class="type">char</span> *a2, <span class="type">int</span> length)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// r3</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// r4</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// r5</span></span><br><span class="line"></span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( length )</span><br><span class="line">  &#123;</span><br><span class="line">    --length;</span><br><span class="line">    v4 = (v4 + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">    v5 = (<span class="type">unsigned</span> __int8)result[v4];</span><br><span class="line">    v3 = (v3 + v5) % <span class="number">256</span>;</span><br><span class="line">    result[v4] = result[v3];</span><br><span class="line">    result[v3] = v5;</span><br><span class="line">    *a2++ ^= result[(<span class="type">unsigned</span> __int8)(v5 + result[v4])];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**********************************************与明文校验前的混淆函数*********************************************/</span></span><br><span class="line"><span class="type">char</span> *__fastcall <span class="title function_">sub_10D4</span><span class="params">(<span class="type">char</span> *result, <span class="type">int</span> length, <span class="type">char</span> *key, <span class="type">int</span> keylength)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// r4</span></span><br><span class="line">  <span class="type">char</span> *v5; <span class="comment">// r6</span></span><br><span class="line">  <span class="type">char</span> v6; <span class="comment">// r5</span></span><br><span class="line">  <span class="type">char</span> v7; <span class="comment">// lr</span></span><br><span class="line">  <span class="type">char</span> v8; <span class="comment">// r12</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// lr</span></span><br><span class="line">  <span class="type">int</span> k; <span class="comment">// r6</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; length; i += <span class="number">3</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = &amp;result[i];</span><br><span class="line">    v6 = result[i + <span class="number">2</span>];</span><br><span class="line">    v7 = result[i + <span class="number">1</span>];</span><br><span class="line">    v8 = result[i] ^ v6;</span><br><span class="line">    result[i] = v8;</span><br><span class="line">    v5[<span class="number">2</span>] = v6 ^ v7;</span><br><span class="line">    v5[<span class="number">1</span>] = v7 ^ v8;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; length; j += keylength )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( k = <span class="number">0</span>; (keylength &amp; ~(keylength &gt;&gt; <span class="number">31</span>)) != k &amp;&amp; j + k &lt; length; ++k )</span><br><span class="line">      result[k] ^= key[k];</span><br><span class="line">    result += keylength;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>写了个python脚本用于求解混淆前的rc4密文</p><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sub_10d4</span>(<span class="params">result,length,key,keylength</span>):</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,length,<span class="number">3</span>):</span><br><span class="line">v6=result[i+<span class="number">2</span>]</span><br><span class="line">v7=result[i+<span class="number">1</span>]</span><br><span class="line">v8=result[i]^v6</span><br><span class="line">result[i]=v8</span><br><span class="line">result[i+<span class="number">2</span>]=v6^v7</span><br><span class="line">result[i+<span class="number">1</span>]=v7^v8</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,length,keylength):</span><br><span class="line">k=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span>((keylength&amp;~(keylength&gt;&gt;<span class="number">31</span>)!=k)<span class="keyword">and</span> j+k&lt;length):</span><br><span class="line">result[k+j]^=<span class="built_in">ord</span>(key[k])</span><br><span class="line">k+=<span class="number">1</span></span><br><span class="line"><span class="keyword">return</span> result</span><br><span class="line">flag = [BitVec(<span class="string">&#x27;flag[%2d]&#x27;</span> % i, <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">39</span>)]  <span class="comment">#初始化序列</span></span><br><span class="line">cmp=[<span class="number">0xA3</span>,<span class="number">0x1A</span>,<span class="number">0xE3</span>,<span class="number">0x69</span> ,<span class="number">0x2F</span> </span><br><span class="line">,<span class="number">0xBB</span>,<span class="number">0x1A</span>,<span class="number">0x84</span>,<span class="number">0x65</span> ,<span class="number">0xC2</span></span><br><span class="line">,<span class="number">0xAD</span>,<span class="number">0xAD</span>,<span class="number">0x9E</span>,<span class="number">0x96</span>,   <span class="number">5</span></span><br><span class="line">,   <span class="number">2</span>,<span class="number">0x1F</span>,<span class="number">0x8E</span>,<span class="number">0x36</span> ,<span class="number">0x4F</span> </span><br><span class="line">,<span class="number">0xE1</span>,<span class="number">0xEB</span>,<span class="number">0xAF</span>,<span class="number">0xF0</span>,<span class="number">0xEA</span></span><br><span class="line">,<span class="number">0xC4</span>,<span class="number">0xA8</span>,<span class="number">0x2D</span> ,<span class="number">0x42</span> ,<span class="number">0xC7</span></span><br><span class="line">,<span class="number">0x6E</span> ,<span class="number">0x3F</span> ,<span class="number">0xB0</span>,<span class="number">0xD3</span>,<span class="number">0xCC</span></span><br><span class="line">,<span class="number">0x78</span> ,<span class="number">0xF9</span>,<span class="number">0x98</span>,<span class="number">0x3F</span> ,   <span class="number">0</span>]</span><br><span class="line">out=[<span class="number">0</span>]*<span class="number">39</span></span><br><span class="line">f=Solver()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">39</span>):</span><br><span class="line">out[i]=flag[i]</span><br><span class="line">out=sub_10d4(out,<span class="number">39</span>,<span class="string">&quot;12345678&quot;</span>,<span class="number">8</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">39</span>):</span><br><span class="line">f.add(out[i]==cmp[i])</span><br><span class="line"><span class="keyword">if</span>(f.check()==sat):</span><br><span class="line">m = f.model()</span><br><span class="line">str1=<span class="string">&#x27;[&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">39</span>):</span><br><span class="line">str1+=<span class="string">&#x27;&#123;:0&gt;2X&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">int</span>(<span class="built_in">str</span>(m[flag[i]])))+<span class="string">&#x27; &#x27;</span></span><br><span class="line">str1+=<span class="string">&#x27;]&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(str1)</span><br><span class="line">  <span class="comment">#str1=[F8 BA 6A 97 47 CA E8 91 C5 07 6E F7 92 0B 39 92 14 A8 AF 7E AA 50 45 8D 6D 2D B6 86 6E 9F 86 5E DF B3 1E 52 A6 62 6A ]</span></span><br></pre></td></tr></table></figure></div><p>直接拿去rc4解密就行，key是12345678</p><p><img                       lazyload                     src="/images/loading.svg"                     data-src="https://cdn.jsdelivr.net/gh/runwu2204/Blog_imgs/202306170057136.png"                      alt="image-20230617005742016"                ></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;查看组件，就一个activity，直接看&lt;/p&gt;
&lt;div class=&quot;highlight-container&quot; data-rel=&quot;Xml&quot;&gt;&lt;figure class=&quot;iseeu highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter</summary>
      
    
    
    
    <category term="CTF WP" scheme="http://example.com/categories/CTF-WP/"/>
    
    <category term="Re" scheme="http://example.com/categories/CTF-WP/Re/"/>
    
    <category term="安卓" scheme="http://example.com/categories/CTF-WP/Re/%E5%AE%89%E5%8D%93/"/>
    
    
  </entry>
  
</feed>
